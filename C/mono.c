//	Version of February 2025


#include "methods_common.h"


static double mono_rho(const unsigned n, const double x, const FcnEqDiff f,
	double* yn, double* fn, double* v, double* fv, double* eigvec,
	const double hmax, const double uround, unsigned iwork[10])
{
	const double safe = 1.2;
	const unsigned itmax = 50;
	const double sqrtu = sqrt(uround), small = 1. / hmax;
	double ynrm = 0., vnrm = 0., sprad, sigma, sigmal, dynrm, dfnrm;
	unsigned i, iter, index;

	if (iwork[5] == 0)
	{
		memcpy(v, fn, n * sizeof(double));
	}
	else
	{
		memcpy(v, eigvec, n * sizeof(double));
	}

	for (i = 0; i < n; i++)
	{
		ynrm += yn[i] * yn[i];
		vnrm += v[i] * v[i];
	}
	ynrm = sqrt(ynrm);
	vnrm = sqrt(vnrm);

	if (ynrm != 0.)
	{
		dynrm = ynrm * sqrtu;
		if (vnrm != 0.)
		{
			for (i = 0; i < n; i++)
			{
				v[i] = yn[i] + v[i] * (dynrm / vnrm);
			}
		}
		else
		{
			for (i = 0; i < n; i++)
			{
				v[i] = yn[i] + yn[i] * sqrtu;
			}
		}
	}
	else
	{
		dynrm = uround;
		if (vnrm != 0.)
		{
			dynrm = uround;
			for (i = 0; i < n; i++)
			{
				v[i] *= (dynrm / vnrm);
			}
		}
		else
		{
			for (i = 0; i < n; i++)
			{
				v[i] = dynrm;
			}
		}
	}

	sigma = 0.;
	for (iter = 1; iter <= itmax; iter++)
	{
		f(&n, &x, v, fv);
		iwork[8]++;
		dfnrm = 0.;
		for (i = 0; i < n; i++)
		{
			dfnrm += pow(fv[i] - fn[i], 2);
		}
		dfnrm = sqrt(dfnrm);
		sigmal = sigma;
		sigma = dfnrm / dynrm;
		sprad = safe * sigma;

		if (iter >= 2 && fabs(sigma - sigmal) <= 0.01 * fmax(sigma, small))
		{
			for (i = 0; i < n; i++)
			{
				eigvec[i] = v[i] - yn[i];
			}
			return sprad;
		}

		if (dfnrm != 0.)
		{
			for (i = 0; i < n; i++)
			{
				v[i] = yn[i] + (fv[i] - fn[i]) * (dynrm / dfnrm);
			}
		}
		else
		{
			index = 1 + iter % n;
			v[index] = yn[index] - (v[index] - yn[index]);
		}
	}

	return -1;
}


static void step_mono(const unsigned n, const double x, const FcnEqDiff f,
	const double* yn, const double* fn, const double h, 
	const unsigned m, const double w0, const double w1,
	const double b, const double c, const double d,
	double* y, double* yjm1, double* yjm2)
{
	unsigned i;
	double* swap, * res = y;

	memcpy(yjm2, yn, n * sizeof(double));

	double bjm1 = 1. / (1. + w0), bjm2 = 0.5;
	double mus = w1 * bjm1;
	for (i = 0; i < n; i++)
	{
		yjm1[i] = yn[i] + h * mus * fn[i];
	}
	
	const double acoshw0 = acosh(w0);
	double thjm2 = 0., thjm1 = mus;
	double zjm1 = w0, zjm2 = 1.;
	double zj, bj, ajm1, mu, nu, thj, cj, bjdbjm1, onemmumnu;
	for (unsigned j = 2; j <= m; j++)
	{
		zj = cosh(j * acoshw0);
		bj = 1. / (1. + zj);
		bjdbjm1 = bj / bjm1;
		mu = 2. * w0 * bjdbjm1;
		nu = -bj / bjm2;
		mus = 2. * w1 * bjdbjm1;
		ajm1 = 1. - zjm1 * bjm1;
		onemmumnu = 1. - mu - nu;

		cj = x + h * thjm1;
		f(&n, &cj, yjm1, y);
		for (i = 0; i < n; i++)
		{
			y[i] = mu * yjm1[i] + nu * yjm2[i] + onemmumnu * yn[i] + h * mus * (y[i] - ajm1 * fn[i]);
		}
		thj = mu * thjm1 + nu * thjm2 + mus * (1. - ajm1);

		if (j < m)
		{
			swap = yjm2;
			yjm2 = yjm1;
			yjm1 = y;
			y = swap;

			thjm2 = thjm1;
			thjm1 = thj;
			bjm2 = bjm1;
			bjm1 = bj;
			zjm2 = zjm1;
			zjm1 = zj;
		}
	}

	mu = c / bj;
	nu = -d / bjm2;
	onemmumnu = 1. - mu - nu;
	for (i = 0; i < n; i++)
	{
		res[i] = onemmumnu * yn[i] + mu * y[i] + nu * yjm2[i] + b * h * fn[i];
	}
}


static int mono_core(const unsigned n, double x, const double xend, double* y,
	const FcnEqDiff f, const Rho rho, const SolTrait solout,
	const double* atol, const double rtol, const double uround,
	double* work, unsigned iwork[10])
{
	const double coef[1900] =
	{
		1.25992104989487, 0.629960524947436,
		1.62112287559371, 0.461799557423497,
		1.49153783215815, 0.289078337064964,
		1.41159230666938, 0.204242946712647,
		1.33352342205729, 0.149540389898826,
		1.28165279459095, 0.115873375389662,
		1.2376363205936, 0.0919686100919294,
		1.20573711688876, 0.075363337469537,
		1.17870268777018, 0.0627424384159399,
		1.15792446562151, 0.053307898493517,
		1.14006644095802, 0.0457960047050783,
		1.12576491293764, 0.0398990164807152,
		1.11329103155459, 0.0350451376386471,
		1.1029956147905, 0.0310995046307415,
		1.09389831348984, 0.0277702160391496,
		1.08621517576777, 0.024992349852874,
		1.07935044151358, 0.0226029752933824,
		1.07344700808642, 0.0205685688366842,
		1.06812252168438, 0.0187917267953202,
		1.0634763387509, 0.0172541982288459,
		1.059252026115, 0.0158945000742861,
		1.05552129207776, 0.0147022932497011,
		1.05210581608636, 0.0136370187683194,
		1.0490588877494, 0.0126926472450894,
		1.04625269532559, 0.0118414287902886,
		1.04372779279995, 0.0110797781888091,
		1.04139018939246, 0.0103881180439431,
		1.03927136502645, 0.00976429501264988,
		1.03730066072952, 0.00919413154954001,
		1.03550292863883, 0.00867633512241987,
		1.03382402481015, 0.00820040458600115,
		1.03228385750954, 0.00776557541937322,
		1.03084023761629, 0.007363915312552,
		1.02950931820823, 0.00699498844073784,
		1.02825773614689, 0.00665269864394228,
		1.02709874673211, 0.00633681666218062,
		1.02600561757201, 0.00604258531625548,
		1.02498933638113, 0.0057699056413057,
		1.02402823043872, 0.0055150144094316,
		1.02313149079475, 0.00527789458046086,
		1.02228135988452, 0.00505553258608515,
		1.02148558921666, 0.00484796226118926,
		1.02072948919149, 0.00465274359591721,
		1.02001964620213, 0.00446994119389831,
		1.01934380238445, 0.00429755958592296,
		1.0187075924254, 0.00413568105627362,
		1.01810070608356, 0.00398265875574698,
		1.01752799410806, 0.00383858411916506,
		1.01698072107467, 0.00370208664388442,
		1.01646308699573, 0.00357326137602119,
		1.01596764100516, 0.00345095903401027,
		1.01549803909996, 0.00333527471444323,
		1.01504788668901, 0.00322523783647946,
		1.0146203819787, 0.00312094130256114,
		1.01421000543205, 0.00302156009446636,
		1.01381956767104, 0.0029271835542444,
		1.01344427910603, 0.00283710615250729,
		1.01308662035026, 0.00275141289097477,
		1.01274241463803, 0.0026694970313654,
		1.01241386010804, 0.00259143884513809,
		1.01209729757497, 0.00251671381932863,
		1.01179468219269, 0.0024453973625139,
		1.01150279436483, 0.00237703382635666,
		1.0112233792591, 0.00231169379118293,
		1.01095359258723, 0.00224897962019208,
		1.01069499725671, 0.00218895720609848,
		1.01044507098303, 0.00213127804825382,
		1.01020521782929, 0.00207600355676945,
		1.00997319305892, 0.00202282706333014,
		1.00975026176239, 0.00197180573659951,
		1.00953441947473, 0.00192266869445788,
		1.00932680925512, 0.00187546912242013,
		1.00912563549482, 0.00182996689162437,
		1.00893193372728, 0.0017862114672321,
		1.00874409059689, 0.00174398926207235,
		1.00856304658223, 0.00170334627998435,
		1.00838734795049, 0.00166409193373069,
		1.00821785088858, 0.0016262690158612,
		1.00805324195288, 0.00158970694659169,
		1.00789430236218, 0.00155444554506627,
		1.00773984237753, 0.00152033169929888,
		1.0075905763544, 0.00148740247903704,
		1.00744542397703, 0.00145552007562732,
		1.00730503980642, 0.00142471901879645,
		1.00716844060647, 0.00139487495110834,
		1.00703622732861, 0.00136602005689905,
		1.00690750311039, 0.00133804183905183,
		1.00678282072155, 0.00131097031670652,
		1.00666136035657, 0.00128470348156787,
		1.00654363138086, 0.0012592693539148,
		1.00642888291217, 0.00123457522781288,
		1.00631758512795, 0.0012106472778908,
		1.00620904894688, 0.00118740107078451,
		1.00610370908963, 0.00116486107637696,
		1.00600093202069, 0.00114295023723455,
		1.00590112031417, 0.00112169144794405,
		1.00580369047174, 0.00110101424393061,
		1.00570901586473, 0.00108094006332976,
		1.0056165581677, 0.00106140434855279,
		1.00552666417338, 0.00104242719035139,
		1.00543883642286, 0.00102394933571377,
		1.00535339747474, 0.0010059896280878,
		1.00526988691492, 0.000988493588524451,
		1.00518860516692, 0.000971478905005405,
		1.00510912546177, 0.000954895404248235,
		1.0050317279712, 0.000938759703059645,
		1.00495601654027, 0.000923025519254405,
		1.00488225278195, 0.000907708475854237,
		1.00481006844694, 0.000892765813974496,
		1.00473970811443, 0.000878212233936081,
		1.0046708290156, 0.000864008173110938,
		1.00460366007201, 0.000850167474444337,
		1.00453788181942, 0.000836653480120194,
		1.00447370876577, 0.00082347923577525,
		1.00441084279532, 0.000810610728136185,
		1.00434948512895, 0.000798060260797868,
		1.00428935723762, 0.000785796232127478,
		1.00423064807708, 0.000773830254561641,
		1.00417309711525, 0.000762132929285279,
		1.00411688197119, 0.000750715224457626,
		1.00406175867288, 0.000739549756493037,
		1.00400789434756, 0.000728646892497488,
		1.00395506028219, 0.000717981095292551,
		1.0039034138822, 0.000707562170813099,
		1.00385274051357, 0.00069736627608506,
		1.00380318856264, 0.000687402692698559,
		1.00375455640261, 0.000677649134428974,
		1.00370698404304, 0.000668114392552379,
		1.0036602818892, 0.00065877761325161,
		1.00361458216174, 0.000649647128960189,
		1.00356970640961, 0.000640703405607643,
		1.00352577960325, 0.000631954345912246,
		1.00348263362464, 0.000623381633314382,
		1.00344038668844, 0.000614992767795685,
		1.00339888026891, 0.000606770557391868,
		1.00335822627919, 0.000598722124355688,
		1.00331827510816, 0.000590831316749743,
		1.00327913278526, 0.000583104902296672,
		1.00324065799309, 0.000575527692005493,
		1.00320295126228, 0.000568106120605843,
		1.00316587899959, 0.000560825891700901,
		1.0031295365917, 0.000553693127037,
		1.00309379764642, 0.000546694358514253,
		1.00305875273403, 0.000539835413500328,
		1.00302428218237, 0.000533103593352588,
		1.00299047204802, 0.00052650444837121,
		1.00295720893596, 0.000520025995457453,
		1.00292457466911, 0.000513673523963526,
		1.00289246172139, 0.000507435716874486,
		1.00286094794139, 0.000501317617615454,
		1.00282993129527, 0.000495308529826425,
		1.00279948589769, 0.000489413265012647,
		1.00276951485914, 0.000483621705694417,
		1.00274008878337, 0.000477938444528362,
		1.00271111560343, 0.000472353904457316,
		1.00268266261936, 0.000466872471495692,
		1.00265464228897, 0.000461485073565631,
		1.0026271188011, 0.000456195901446014,
		1.00260000886239, 0.000450996355338307,
		1.00257337372971, 0.000445890441452483,
		1.00254713410255, 0.00044087000206876,
		1.00252134847269, 0.000435938868809503,
		1.00249594129489, 0.000431089298113091,
		1.00247096845134, 0.000426324956360477,
		1.0024463579313, 0.000421638488309857,
		1.00242216315251, 0.000417033403857982,
		1.00239831543335, 0.00041250271214834,
		1.00237486586257, 0.000408049774804102,
		1.00235174889657, 0.000403667943162135,
		1.00232901342166, 0.00039936043827504,
		1.00230659685418, 0.000395120933077934,
		1.00228454599637, 0.000390952515284139,
		1.00226280105846, 0.000386849160296596,
		1.00224140686941, 0.000382813829281953,
		1.00222030627833, 0.000378840782325486,
		1.00219954224467, 0.000374932860431563,
		1.00217906011171, 0.000371084591818504,
		1.00215890106659, 0.000367298703332658,
		1.0021390128115, 0.000363569975913485,
		1.00211943485245, 0.000359901027899381,
		1.00210011712398, 0.0003562868785865,
		1.00208109753659, 0.000352730043125097,
		1.00206232813872, 0.000349225765769137,
		1.0020438453257, 0.000345776463492434,
		1.00202560314893, 0.000342377592998761,
		1.00200763656412, 0.000339031477809537,
		1.00198990152158, 0.000335733775393053,
		1.00197243160846, 0.000332486720273679,
		1.00195518457639, 0.000329286159759368,
		1.00193819271082, 0.000326134243581624,
		1.00192141547306, 0.000323026998666672,
		1.00190488390982, 0.000319966493922431,
		1.00188855910607, 0.000316948926323329,
		1.00187247092905, 0.000313976287703154,
		1.00185658200649, 0.000311044936117996,
		1.00184092108212, 0.000308156789871131,
		1.0018254522503, 0.000305308359693469,
		1.001810203184, 0.000302501493708541,
		1.00179513937263, 0.000299732847434705,
		1.00178028746817, 0.000297004201985725,
		1.0017656142876, 0.000294312350262525,
		1.00175114550897, 0.000291659009369517,
		1.00173684921328, 0.000289041102633795,
		1.00172275014904, 0.000286460285991702,
		1.00170881760137, 0.000283913606657302,
		1.00169507543125, 0.000281402662090727,
		1.00168149407137, 0.000278924617242176,
		1.00166809653493, 0.000276481013647047,
		1.00165485434878, 0.000274069128202625,
		1.00164178971597, 0.000271690448939103,
		1.00162887520714, 0.000269342359249055,
		1.00161613225077, 0.000267026295952906,
		1.00160353441362, 0.000264739743801338,
		1.00159110238338, 0.000262484090583673,
		1.00157881067788, 0.000260256917565205,
		1.001566679276, 0.0002580595655729,
		1.00155468360402, 0.000255889707817491,
		1.00154284296234, 0.0002537486401288,
		1.00153113364536, 0.000251634123350235,
		1.00151957430377, 0.000249547410182129,
		1.00150814206192, 0.000247486345027622,
		1.00149685494809, 0.000245452139233232,
		1.00148569088035, 0.000243442716913322,
		1.00147466729056, 0.000241459249749513,
		1.00146376285621, 0.000239499737929063,
		1.00145299443736, 0.00023756531507574,
		1.00144234143839, 0.000235654054008302,
		1.001431820171, 0.000233767051822421,
		1.00142141073556, 0.000231902450711595,
		1.00141112891772, 0.000230061312700149,
		1.00140095548454, 0.000228241846272772,
		1.0013909057168, 0.000226445079770209,
		1.00138096102041, 0.000224669285047368,
		1.00137113619146, 0.000222915458083964,
		1.00136141324826, 0.000221181931336845,
		1.00135180652144, 0.000219469669685561,
		1.00134229861658, 0.000217777063564099,
		1.0013329034171, 0.000216105047954357,
		1.00132360409197, 0.000214452068777548,
		1.00131441409487, 0.000212819032265188,
		1.00130531713537, 0.000211204437462704,
		1.00129632625405, 0.000209609162946187,
		1.00128742567944, 0.00020803175864169,
		1.00127862805487, 0.000206473076515279,
		1.00126991810723, 0.000204931715242507,
		1.00126130809769, 0.00020340850117785,
		1.00125278323188, 0.000201902079721189,
		1.00124435540329, 0.000200413252569309,
		1.00123601027755, 0.000198940709921117,
		1.00122775939422, 0.000197485229727375,
		1.00121958886113, 0.000196045545154896,
		1.00121150987709, 0.00019462241128001,
		1.00120350897508, 0.000193214602495178,
		1.00119559702576, 0.000191822851835852,
		1.00118776097105, 0.000190445973261766,
		1.00118001136546, 0.000189084678564923,
		1.00117233554435, 0.000187737819693171,
		1.00116474375759, 0.000186406087958184,
		1.0011572237192, 0.000185088371791617,
		1.0011497853854, 0.000183785342755321,
		1.00114241683476, 0.0001824959243312,
		1.00113512774034, 0.000181220769030798,
		1.00112790653178, 0.00017995883401961,
		1.00112076260907, 0.000178710753428917,
		1.00111368473998, 0.000177475516804444,
		1.0011066820611, 0.000176253740539212,
		1.00109974366602, 0.00017504444531573,
		1.00109287843713, 0.000173848230404074,
		1.00108607578203, 0.00017266414643682,
		1.00107934433779, 0.000171492776151016,
		1.00107267381475, 0.000170333198996324,
		1.00106607261309, 0.000169185981742498,
		1.00105953073511, 0.000168050231574228,
		1.00105305635224, 0.000166926499836663,
		1.0010466397484, 0.000165813920415747,
		1.00104028887405, 0.00016471302975276,
		1.00103399428483, 0.000163622987446913,
		1.00102776371772, 0.000162544315535427,
		1.00102158799057, 0.00016147619838624,
		1.00101547463407, 0.000160419144112366,
		1.00100941471921, 0.00015937236094717,
		1.00100341557722, 0.000158336343540279,
		1.00099746852355, 0.00015731032312634,
		1.0009915806966, 0.000156294781334254,
		1.00098574364789, 0.000155288971572998,
		1.00097996432935, 0.00015429336287608,
		1.00097423452055, 0.000153307230035196,
		1.00096856099306, 0.000152331029897246,
		1.00096293574682, 0.000151364057878633,
		1.00095736537886, 0.000150406759032635,
		1.00095184210213, 0.000149458448674296,
		1.00094637234477, 0.000148519560441162,
		1.00094094852565, 0.000147589428851245,
		1.00093557690941, 0.000146668476489828,
		1.00093025011405, 0.000145756056411136,
		1.00092497424594, 0.00014485258049787,
		1.00091974211565, 0.000143957419701244,
		1.00091455967626, 0.000143070975537881,
		1.00090941992469, 0.000142192636242972,
		1.00090432866554, 0.000141322793290961,
		1.00089927907602, 0.000140460851612976,
		1.00089427681688, 0.00013960719295312,
		1.00088931523983, 0.000138761238374215,
		1.00088439986628, 0.000137923360190325,
		1.00087952421681, 0.000137092995054403,
		1.00087469367777, 0.000136270506139729,
		1.00086990193332, 0.000135455345169448,
		1.00086515423884, 0.000134647866454744,
		1.0008604444369, 0.000133847536289641,
		1.00085577765592, 0.000133054700391786,
		1.00085114789192, 0.000132268839146453,
		1.00084656015018, 0.000131490289936606,
		1.0008420085754, 0.000130718546777924,
		1.00083749805345, 0.000129953938968256,
		1.00083302287306, 0.000129195973710766,
		1.00082858780427, 0.000128444972458846,
		1.00082418727546, 0.000127700455177353,
		1.00081982594422, 0.000126962735707342,
		1.00081549837433, 0.00012623134636593,
		1.00081120911427, 0.000125506593605766,
		1.00080695285908, 0.000124788021702422,
		1.00080273405135, 0.00012407592993622,
		1.00079854751341, 0.000123369874162324,
		1.00079439758505, 0.000122670146697273,
		1.00079027921209, 0.000121976314611246,
		1.00078619663446, 0.00012128866345831,
		1.0007821449178, 0.000120606771172744,
		1.00077812820509, 0.000119930916740518,
		1.00077414167822, 0.000119260688622161,
		1.00077018938598, 0.000118596359423259,
		1.00076626662311, 0.000117937527805246,
		1.00076237734688, 0.000117284460174642,
		1.00075851696157, 0.00011663676508041,
		1.00075468933554, 0.000115994702905174,
		1.00075088997941, 0.000115357891783512,
		1.00074712267513, 0.000114726586243419,
		1.00074338303659, 0.000114100413714147,
		1.00073967476175, 0.000113479623032659,
		1.0007359935648, 0.00011286385064245,
		1.00073234306203, 0.000112253339847595,
		1.00072871906508, 0.000111647735835477,
		1.00072512511083, 0.000111047276530183,
		1.00072155710557, 0.000110451615602282,
		1.00071801850899, 0.000109860985743735,
		1.00071450531937, 0.00010927504885685,
		1.00071102092128, 0.000108694032544475,
		1.00070756140241, 0.000108117606698085,
		1.00070413007425, 0.000107545993969764,
		1.00070072311143, 0.000106978872006092,
		1.00069734375433, 0.000106416458642254,
		1.00069398826209, 0.000105858439054039,
		1.0006906598059, 0.000105305026389276,
		1.00068735472706, 0.000104755913134906,
		1.00068407612945, 0.000104211307876792,
		1.00068082043427, 0.000103670910202484,
		1.00067759067985, 0.000103134924257265,
		1.00067438336512, 0.000102603056525978,
		1.00067120146461, 0.00010207550683086,
		1.00066804155286, 0.00010155198835766,
		1.00066490654229, 0.000101032696719389,
		1.00066179308099, 0.000100517351612978,
		1.00065870402088, 0.000100006144552459,
		1.00065563608167, 9.94988015626174E-05,
		1.00065259205632, 9.89955101653016E-05,
		1.00064956873425, 9.84960025359762E-05,
		1.00064656885101, 9.80004623077855E-05,
		1.00064358926385, 9.75086276356025E-05,
		1.00064063265241, 9.70206783641452E-05,
		1.00063769593996, 9.65363584621073E-05,
		1.00063478175165, 9.60558440829715E-05,
		1.00063188707508, 9.55788848491271E-05,
		1.00062901448228, 9.51056533170375E-05,
		1.00062616102346, 9.46359046079163E-05,
		1.00062332921891, 9.41698077725523E-05,
		1.00062051617985, 9.37071232811669E-05,
		1.00061772437608, 9.32480167674509E-05,
		1.00061495097827, 9.27922539056797E-05,
		1.00061219840702, 9.23399969983509E-05,
		1.00060946389089, 9.18910167835207E-05,
		1.00060674980253, 9.14454723158206E-05,
		1.00060405342689, 0.000091003139261319,
		1.00060137708986, 9.05641735076205E-05,
		1.00059871813138, 0.000090128355517375,
		1.00059607883169, 8.96958380895968E-05,
		1.00059345658433, 8.92664063562636E-05,
		1.00059085362505, 8.88402101039173E-05,
		1.00058826739962, 8.84170390106324E-05,
		1.00058570010038, 8.79970399243568E-05,
		1.00058314922401, 8.75800069499065E-05,
		1.00058061692052, 8.71660840683508E-05,
		1.00057810073623, 8.67550696956262E-05,
		1.00057560277982, 8.63471050155491E-05,
		1.00057312064605, 8.59419926431547E-05,
		1.00057065640325, 8.55398710326131E-05,
		1.00056820769341, 8.51405468895059E-05,
		1.00056577654549, 8.47441560040123E-05,
		1.00056336064756, 8.43505090670522E-05,
		1.00056096199015, 8.39597392685842E-05,
		1.00055857830625, 8.35716611828834E-05,
		1.0005562115489, 8.31864054616354E-05,
		1.00055385949494, 8.28037904635981E-05,
		1.00055152406076, 8.24239443623691E-05,
		1.00054920306599, 8.20466892053175E-05,
		1.00054689839126, 8.16721507464337E-05,
		1.00054460789796, 8.13001546287213E-05,
		1.00054233343178, 8.09308242433963E-05,
		1.00054007289488, 8.05639887389143E-05,
		1.00053782809881, 8.01997691989551E-05,
		1.00053559698552, 7.98379981899396E-05,
		1.00053338133324, 7.94787945417081E-05,
		1.00053117912276, 7.91219941537632E-05,
		1.00052899209974, 7.87677136543098E-05,
		1.0005268182829, 7.84157921935613E-05,
		1.0005246593861, 7.80663442488474E-05,
		1.00052251346507, 0.000077719212141149,
		1.00052038220258, 7.73745082462823E-05,
		1.00051826369055, 7.70320779783963E-05,
		1.00051615958135, 7.66920316598031E-05,
		1.00051406800224, 7.63542177224839E-05,
		1.00051199057589, 7.60187444819459E-05,
		1.00050992546406, 7.56854633148555E-05,
		1.0005078742604, 0.000075354480575345,
		1.00050583516039, 7.50256505137324E-05,
		1.0005038097293, 7.46990775669775E-05,
		1.00050179619553, 7.43746187900592E-05,
		1.00049979609663, 7.40523767457772E-05,
		1.00049780769319, 7.37322112267558E-05,
		1.00049583249562, 0.000073414222963494,
		1.00049386879597, 7.30982744211559E-05,
		1.00049191807812, 7.27844645386819E-05,
		1.00048997866487, 7.24726583905164E-05,
		1.00048805201415, 7.21629531637021E-05,
		1.0004861364788, 7.18552164804893E-05,
		1.0004842334914, 7.15495438146344E-05,
		1.00048234143417, 7.12458052764474E-05,
		1.00048046171484, 0.000070944094663993,
		1.00047859274436, 7.06442845175649E-05,
		1.0004767359062, 7.03464669961453E-05,
		1.00047488963938, 0.000070050517013553,
		1.00047305530359, 6.97565251253413E-05,
		1.00047123136534, 6.94643685639593E-05,
		1.00046941916108, 6.91741363162585E-05,
		1.00046761718415, 6.88857078799382E-05,
		1.00046582674827, 6.85991707069767E-05,
		1.00046404637304, 6.83144065084086E-05,
		1.00046227734993, 0.000068031501234296,
		1.00046051822423, 6.77503387585137E-05,
		1.00045877026561, 6.74710035613187E-05,
		1.00045703204451, 6.71933816303046E-05,
		1.00045358715491, 6.66434147455701E-05,
		1.00045018289033, 6.61003202807393E-05,
		1.00044681859922, 6.55639829017866E-05,
		1.00044349364321, 6.50342897010696E-05,
		1.00044020739684, 6.45111301360362E-05,
		1.00043695924717, 6.39943959697363E-05,
		1.00043374859356, 6.34839812130777E-05,
		1.00043057484733, 6.29797820687692E-05,
		1.00042743743144, 6.24816968768924E-05,
		1.0004243357803, 6.19896260620501E-05,
		1.00042126933941, 6.15034720820383E-05,
		1.00041823756514, 0.000061023139377992,
		1.00041523992447, 6.05485343259558E-05,
		1.00041227589472, 6.00795651898342E-05,
		1.00040934496335, 5.96161420756751E-05,
		1.00040644662766, 5.91581768872449E-05,
		1.00040358039463, 5.87055832828525E-05,
		1.00040074578063, 5.82582766333822E-05,
		1.00039794231127, 5.78161739814981E-05,
		1.00039516952112, 5.73791940019806E-05,
		1.00039242695355, 5.69472569631609E-05,
		1.00038971416054, 5.65202846894184E-05,
		1.00038703070242, 5.60982005247065E-05,
		1.00038437614776, 5.56809292970764E-05,
		1.00038175007314, 5.52683972841661E-05,
		1.00037915206295, 5.48605321796254E-05,
		1.00037658170927, 5.44572630604486E-05,
		1.00037403861168, 5.40585203551846E-05,
		1.00037152237706, 5.36642358130007E-05,
		1.00036903261947, 0.000053274342473571,
		1.00036656895997, 5.28887746377662E-05,
		1.00036413102648, 5.25074678391195E-05,
		1.00036171845362, 5.21303588160456E-05,
		1.00035933088256, 5.17573854847901E-05,
		1.0003569679609, 5.13884869130868E-05,
		1.0003546293425, 5.10236032945025E-05,
		1.00035231468738, 5.06626759234487E-05,
		1.00035002366155, 5.03056471708396E-05,
		1.00034775593693, 4.99524604603785E-05,
		1.00034551119117, 4.96030602454533E-05,
		1.00034328910756, 4.92573919866233E-05,
		1.00034108937492, 4.89154021296805E-05,
		1.00033891168747, 0.000048577038084268,
		1.00033675574468, 4.82422482030399E-05,
		1.00033462125125, 4.79109817613465E-05,
		1.00033250791691, 4.75831889374305E-05,
		1.00033041545637, 0.000047258820793119,
		1.0003283435892, 4.69378292549961E-05,
		1.00032629203973, 4.66201670960451E-05,
		1.00032426053695, 4.63057879177443E-05,
		1.00032224881442, 4.59946461326046E-05,
		1.00032025661018, 4.56866969471372E-05,
		1.00031828366665, 4.53818963452377E-05,
		1.00031632973055, 4.50802010719764E-05,
		1.00031439455279, 4.47815686177829E-05,
		1.00031247788844, 4.44859572030139E-05,
		1.00031057949658, 4.41933257628936E-05,
		1.00030869914028, 4.39036339328171E-05,
		1.00030683658646, 0.000043616842034006,
		1.00030499160587, 4.33329110595066E-05,
		1.000303163973, 4.30518026605219E-05,
		1.00030135346597, 4.27734791330683E-05,
		1.0002995598665, 4.24979034049473E-05,
		1.00029778295982, 4.22250390230249E-05,
		1.00029602253463, 4.19548501408095E-05,
		1.00029427838299, 4.16873015063203E-05,
		1.00029255030027, 0.00004142235845024,
		1.00029083808511, 4.11599868743412E-05,
		1.00028914153933, 4.09001532401828E-05,
		1.00028746046788, 4.06428245580661E-05,
		1.00028579467877, 4.03879683762458E-05,
		1.00028414398304, 4.01355527703882E-05,
		1.00028250819467, 3.98855463332712E-05,
		1.00028088713053, 3.96379181647176E-05,
		1.00027928061035, 3.93926378617584E-05,
		1.00027768845665, 3.91496755090184E-05,
		1.00027611049466, 0.000038909001669318,
		1.00027454655234, 3.86705873744876E-05,
		1.00027299646024, 3.84344041163871E-05,
		1.00027146005154, 3.82004238381261E-05,
		1.00026993716193, 3.79686189254797E-05,
		1.00026842762961, 3.77389621984955E-05,
		1.00026693129522, 3.75114269032849E-05,
		1.00026544800181, 0.000037285986703997,
		1.00026397759478, 0.000037062615674968,
		1.00026251992186, 3.68412882930428E-05,
		1.00026107483303, 3.66219794300646E-05,
		1.00025964218053, 3.64046643455275E-05,
		1.00025822181878, 3.61893186793895E-05,
		1.00025681360436, 3.59759184450402E-05,
		1.00025541739596, 3.57644400224203E-05,
		1.00025403305434, 3.55548601512894E-05,
		1.00025266044233, 3.53471559246378E-05,
		1.00025129942472, 3.51413047822394E-05,
		1.00024994986832, 3.49372845043413E-05,
		1.00024861164184, 3.47350732054882E-05,
		1.00024728461589, 3.45346493284771E-05,
		1.00024596866297, 3.43359916384394E-05,
		1.0002446636574, 3.41390792170481E-05,
		1.00024336947531, 3.39438914568459E-05,
		1.00024208599458, 3.37504080556924E-05,
		1.00024081309487, 3.35586090113266E-05,
		1.00023955065751, 3.33684746160429E-05,
		1.00023829856555, 3.31799854514771E-05,
		1.00023705670366, 3.29931223835001E-05,
		1.00023582495815, 0.000032807866557217,
		1.00023460321694, 0.000032624199392069,
		1.00023339136949, 3.24421025770349E-05,
		1.00023218930683, 3.22615580659314E-05,
		1.0002309969215, 3.20825480728086E-05,
		1.00022981410752, 3.19050550674388E-05,
		1.00022864076039, 3.17290617708973E-05,
		1.00022747677705, 3.15545511512313E-05,
		1.00022632205585, 3.13815064192168E-05,
		1.00022517649655, 3.12099110242001E-05,
		1.00022404000027, 3.10397486500227E-05,
		1.00022291246948, 3.08710032110275E-05,
		1.00022179380797, 3.07036588481438E-05,
		1.00022068392087, 0.000030537699925051,
		1.00021958271454, 3.03731110244172E-05,
		1.00021849009664, 0.000030209876944212,
		1.00021740597606, 3.00479826940926E-05,
		1.00021633026291, 2.98874134918596E-05,
		1.00021526286851, 2.97281547599829E-05,
		1.00021420370536, 2.95701921221947E-05,
		1.00021315268712, 2.94135114001494E-05,
		1.00021210972859, 2.92580986101474E-05,
		1.0002110747457, 2.91039399599228E-05,
		1.00021004765551, 2.89510218454926E-05,
		1.00020902837613, 0.000028799330848067,
		1.00020801682678, 2.86488537310182E-05,
		1.00020701292771, 2.84995774369072E-05,
		1.00020601660023, 2.83514890845682E-05,
		1.00020502776667, 0.000028204575966247,
		1.00020404635034, 2.80588255447946E-05,
		1.00020307227559, 2.79142254509134E-05,
		1.00020210546771, 2.77707634804554E-05,
		1.00020114585295, 2.76284275917713E-05,
		1.00020019335854, 0.000027487205903109,
		1.00019924791259, 2.73470866900611E-05,
		1.00019830944418, 2.72080583830594E-05,
		1.00019737788325, 2.70701095649166E-05,
		1.00019645316066, 2.69332289684131E-05,
		1.00019553520812, 2.67974054739287E-05,
		1.00019462395822, 2.66626281071179E-05,
		1.00019371934439, 2.65288860366278E-05,
		1.0001928213009, 2.63961685718581E-05,
		1.00019192976283, 2.62644651607618E-05,
		1.0001910446661, 2.61337653876861E-05,
		1.0001901659474, 0.000026004058971253,
		1.00018929354422, 2.58753357622775E-05,
		1.00018842739481, 2.57475857417243E-05,
		1.00018756743821, 2.56207990187007E-05,
		1.00018671361419, 2.54949658284866E-05,
		1.00018586586326, 2.53700765305986E-05,
		1.00018502412668, 2.52461216068896E-05,
		1.00018418834639, 2.51230916596823E-05,
		1.00018335846509, 2.50009774099359E-05,
		1.00018253442613, 2.48797696954449E-05,
		1.00018171617357, 2.47594594690705E-05,
		1.00018090365215, 2.46400377970028E-05,
		1.00018009680727, 0.000024521495857054,
		1.00017929558499, 2.44038249369814E-05,
		1.00017849993201, 2.42870164328397E-05,
		1.00017770979568, 2.41710618473623E-05,
		1.00017692512398, 2.40559527883709E-05,
		1.0001761458655, 2.39416809672129E-05,
		1.00017537196945, 2.38282381972251E-05,
		1.00017460338563, 2.37156163922256E-05,
		1.00017384006445, 0.00002360380756503,
		1.0001730819569, 2.34928038259942E-05,
		1.00017232901455, 2.33825973815823E-05,
		1.00017158118952, 2.32731805329586E-05,
		1.00017083843452, 2.31645456746036E-05,
		1.00017010070279, 2.30566852929544E-05,
		1.00016936794812, 2.29495919650673E-05,
		1.00016864012484, 2.28432583573038E-05,
		1.00016791718783, 2.27376772240383E-05,
		1.00016719909244, 2.26328414063881E-05,
		1.0001664857946, 2.25287438309646E-05,
		1.00016577725069, 2.24253775086456E-05,
		1.00016507341763, 2.23227355333677E-05,
		1.00016437425282, 2.22208110809396E-05,
		1.00016367971414, 2.21195974078752E-05,
		1.00016298975997, 2.20190878502451E-05,
		1.00016230434914, 2.19192758225483E-05,
		1.00016162344095, 2.18201548166024E-05,
		1.00016094699519, 2.17217184004516E-05,
		1.00016027497208, 2.16239602172929E-05,
		1.00015960733228, 2.15268739844207E-05,
		1.00015894403691, 2.14304534921874E-05,
		1.00015828504752, 2.13346926029824E-05,
		1.00015763032609, 2.12395852502265E-05,
		1.00015697983502, 2.11451254373837E-05,
		1.00015633353715, 2.10513072369886E-05,
		1.0001556913957, 2.09581247896892E-05,
		1.00015505337432, 2.08655723033063E-05,
		1.00015441943705, 2.07736440519067E-05,
		1.00015378954834, 2.06823343748927E-05,
		1.00015316367303, 2.05916376761047E-05,
		1.00015254177633, 2.05015484229397E-05,
		1.00015192382384, 2.04120611454829E-05,
		1.00015130978154, 2.03231704356536E-05,
		1.00015069961578, 2.02348709463643E-05,
		1.00015009329328, 2.01471573906937E-05,
		1.00014949078111, 2.00600245410723E-05,
		1.0001488920467, 1.99734672284811E-05,
		1.00014829705783, 1.98874803416629E-05,
		1.00014770578265, 0.000019802058826346,
		1.00014711818962, 1.97171976844804E-05,
		1.00014653424755, 1.96328919734851E-05,
		1.0001459539256, 0.000019549136805508,
		1.00014537719324, 1.94659273466973E-05,
		1.00014480402027, 1.93832588164836E-05,
		1.00014423437681, 1.93011264868735E-05,
		1.00014366823331, 1.92195256817545E-05,
		1.00014310556052, 1.91384517762102E-05,
		1.0001425463295, 1.90579001958459E-05,
		1.00014199051161, 1.89778664161251E-05,
		1.00014143807853, 1.88983459617159E-05,
		1.00014088900223, 1.88193344058471E-05,
		1.00014034325495, 1.87408273696749E-05,
		1.00013980080925, 1.86628205216584E-05,
		1.00013926163797, 1.85853095769453E-05,
		1.00013872571422, 1.85082902967665E-05,
		1.00013819301141, 0.00001843175848784,
		1.00013713716353, 1.82801407345372E-05,
		1.00013609388695, 1.81304236584327E-05,
		1.00013506297855, 1.79825752920479E-05,
		1.00013404423934, 1.78365643414768E-05,
		1.00013303747437, 1.76923601693517E-05,
		1.00013204249262, 1.75499327783112E-05,
		1.00013105910694, 1.74092527949537E-05,
		1.00013008713391, 1.72702914542594E-05,
		1.00012912639376, 0.000017133020584466,
		1.00012817671033, 1.69974125923821E-05,
		1.00012723791092, 1.68634404491249E-05,
		1.00012630982623, 1.67310776762676E-05,
		1.00012539229029, 1.66002983323828E-05,
		1.00012448514038, 1.64710769999695E-05,
		1.00012358821694, 1.63433887727518E-05,
		1.0001227013635, 1.62172092433352E-05,
		1.00012182442661, 1.60925144912113E-05,
		1.00012095725579, 1.59692810710986E-05,
		1.00012009970342, 1.58474860016083E-05,
		1.00011925162469, 1.57271067542256E-05,
		1.00011841287757, 1.56081212425962E-05,
		1.0001175833227, 1.54905078121078E-05,
		1.00011676282333, 1.53742452297583E-05,
		1.00011595124531, 1.52593126743008E-05,
		1.00011514845698, 1.51456897266573E-05,
		1.00011435432912, 1.50333563605927E-05,
		1.00011356873493, 1.49222929336407E-05,
		1.00011279154994, 1.48124801782744E-05,
		1.00011202265197, 1.47038991933132E-05,
		1.0001112619211, 1.45965314355599E-05,
		1.00011050923957, 1.44903587116602E-05,
		1.00010976449178, 1.43853631701775E-05,
		1.00010902756422, 0.000014281527293878,
		1.00010829834543, 0.000014178833892218,
		1.00010757672597, 1.40772660940281E-05,
		1.00010686259833, 1.39768073403892E-05,
		1.00010615585694, 0.000013877441377693,
		1.00010545639812, 1.37791522508824E-05,
		1.00010476411999, 1.36819242968669E-05,
		1.00010407892249, 1.35857421381068E-05,
		1.00010340070733, 1.34905906763624E-05,
		1.00010272937793, 1.33964550866018E-05,
		1.00010206483939, 1.33033208110648E-05,
		1.00010140699848, 1.32111735534764E-05,
		1.00010075576355, 1.31199992734064E-05,
		1.00010011104458, 1.30297841807717E-05,
		1.00009947275306, 1.29405147304753E-05,
		1.00009884080201, 1.28521776171796E-05,
		1.00009821510595, 1.27647597702103E-05,
		1.00009759558083, 1.26782483485855E-05,
		1.00009698214404, 1.25926307361688E-05,
		1.00009637471436, 1.25078945369406E-05,
		1.00009577321194, 1.24240275703861E-05,
		1.00009517755828, 1.23410178669957E-05,
		1.00009458767617, 1.22588536638752E-05,
		1.0000940034897, 1.21775234004622E-05,
		1.00009342492422, 1.20970157143461E-05,
		1.00009285190632, 1.20173194371893E-05,
		1.00009228436379, 1.19384235907455E-05,
		1.00009172222561, 1.18603173829741E-05,
		1.00009116542192, 1.17829902042469E-05,
		1.00009061388401, 1.17064316236444E-05,
		1.00009006754427, 0.000011630631385341,
		1.0000895263362, 1.15555794050742E-05,
		1.00008899019436, 1.14812657666979E-05,
		1.00008845905439, 1.14076807188157E-05,
		1.00008793285294, 1.13348146714932E-05,
		1.00008741152767, 1.12626581930468E-05,
		1.00008689501724, 1.11912020069071E-05,
		1.00008638326129, 1.11204369885545E-05,
		1.00008587620042, 1.10503541625255E-05,
		1.00008537377614, 1.09809446994883E-05,
		1.0000848759309, 1.09121999133844E-05,
		1.00008438260805, 1.08441112586361E-05,
		1.00008389375182, 1.07766703274173E-05,
		1.00008340930732, 1.07098688469861E-05,
		1.0000829292205, 1.06436986770776E-05,
		1.00008245343814, 1.05781518073558E-05,
		1.00008198190785, 1.05132203549221E-05,
		1.00008151457805, 1.04488965618796E-05,
		1.00008105139795, 1.03851727929525E-05,
		1.00008059231751, 1.03220415331573E-05,
		1.00008013728749, 1.02594953855262E-05,
		1.00007968625936, 1.01975270688807E-05,
		1.00007923918535, 1.01361294156543E-05,
		1.00007879601841, 1.00752953697624E-05,
		1.00007835671217, 1.00150179845197E-05,
		1.00007792122098, 9.9552904206023E-06,
		1.00007748949987, 9.89610594405394E-06,
		1.00007706150452, 9.83745792433638E-06,
		1.00007663719129, 9.77933983242088E-06,
		1.00007621651718, 9.72174523892126E-06,
		1.00007579943982, 9.66466781226692E-06,
		1.00007538591745, 9.60810131691492E-06,
		1.00007497590894, 9.55203961160023E-06,
		1.00007456937376, 9.49647664762314E-06,
		1.00007416627197, 9.44140646717298E-06,
		1.0000737665642, 9.38682320168728E-06,
		1.00007337021165, 9.33272107024545E-06,
		1.00007297717609, 9.27909437799622E-06,
		1.00007258741984, 0.000009225937514618,
		1.00007220090576, 9.17324495281137E-06,
		1.00007181759722, 9.12101124682293E-06,
		1.00007143745814, 9.06923103099979E-06,
		1.00007106045295, 9.01789901837397E-06,
		1.00007068654656, 8.96700999927593E-06,
		1.0000703157044, 8.91655883997668E-06,
		1.00006994789238, 8.86654048135767E-06,
		1.00006958307688, 8.81694993760792E-06,
		1.00006922122477, 8.76778229494761E-06,
		1.00006886230337, 8.7190327103777E-06,
		1.00006850628045, 8.6706964104548E-06,
		1.00006815312423, 8.62276869009083E-06,
		1.00006780280339, 8.57524491137684E-06,
		1.00006745528701, 8.52812050243044E-06,
		1.00006711054462, 8.48139095626629E-06,
		1.00006676854615, 8.43505182968919E-06,
		1.00006642926196, 8.38909874220914E-06,
		1.00006609266281, 8.34352737497794E-06,
		1.00006575871984, 8.29833346974692E-06,
		1.0000654274046, 8.2535128278451E-06,
		1.00006509868901, 8.20906130917755E-06,
		1.0000647725454, 8.16497483124339E-06,
		1.00006444894643, 8.12124936817297E-06,
		1.00006412786516, 8.07788094978386E-06,
		1.00006380927498, 8.03486566065519E-06,
		1.00006349314967, 7.99219963921998E-06,
		1.00006317946333, 7.94987907687493E-06,
		1.00006286819042, 7.90790021710754E-06,
		1.00006255930573, 7.86625935463987E-06,
		1.00006225278438, 7.82495283458878E-06,
		1.00006194860183, 7.78397705164228E-06,
		1.00006164673385, 7.74332844925153E-06,
		1.00006134715652, 7.70300351883822E-06,
		1.00006104984626, 7.66299879901699E-06,
		1.00006075477976, 7.62331087483258E-06,
		1.00006046193405, 7.58393637701136E-06,
		1.00006017128642, 7.54487198122691E-06,
		1.00005988281449, 7.50611440737943E-06,
		1.00005959649613, 7.4676604188886E-06,
		1.00005931230953, 7.42950682199966E-06,
		1.00005903023314, 7.39165046510235E-06,
		1.00005875024568, 7.35408823806259E-06,
		1.00005847232615, 7.31681707156641E-06,
		1.00005819645382, 7.27983393647609E-06,
		1.00005792260822, 7.2431358431981E-06,
		1.00005765076912, 7.20671984106265E-06,
		1.00005738091658, 7.17058301771463E-06,
		1.00005711303088, 7.13472249851567E-06,
		1.00005684709256, 7.09913544595701E-06,
		1.0000565830824, 7.06381905908319E-06,
		1.00005632098142, 7.02877057292603E-06,
		1.00005606077088, 6.99398725794894E-06,
		1.00005580243227, 6.9594664195012E-06,
		1.00005554594731, 6.92520539728205E-06,
		1.00005529129794, 6.89120156481441E-06,
		1.00005503846632, 6.85745232892802E-06,
		1.00005478743484, 6.82395512925173E-06,
		1.0000545381861, 6.79070743771493E-06,
		1.00005429070291, 6.75770675805773E-06,
		1.00005404496829, 6.72495062534987E-06,
		1.00005380096548, 6.69243660551808E-06,
		1.00005355867789, 6.66016229488181E-06,
		1.00005331808917, 6.62812531969709E-06,
		1.00005307918313, 6.59632333570834E-06,
		1.00005284194381, 6.5647540277081E-06,
		1.00005260635542, 6.53341510910435E-06,
		1.00005237240236, 6.50230432149543E-06,
		1.00005214006921, 6.47141943425222E-06,
		1.00005190934076, 6.44075824410769E-06,
		1.00005168020195, 6.4103185747534E-06,
		1.00005145263791, 6.38009827644306E-06,
		1.00005122663396, 6.35009522560278E-06,
		1.00005100217558, 6.3203073244481E-06,
		1.0000507792484, 6.29073250060749E-06,
		1.00005055783826, 6.26136870675231E-06,
		1.00005033793114, 6.23221392023305E-06,
		1.00005011951318, 6.20326614272169E-06,
		1.00004990257069, 6.17452339986019E-06,
		1.00004968709015, 6.14598374091485E-06,
		1.00004947305818, 6.11764523843654E-06,
		1.00004926046155, 6.08950598792655E-06,
		1.00004904928721, 6.06156410750816E-06,
		1.00004883952223, 6.03381773760355E-06,
		1.00004863115384, 6.00626504061624E-06,
		1.00004842416942, 5.97890420061873E-06,
		1.00004821855649, 5.95173342304532E-06,
		1.00004801430271, 5.92475093439002E-06,
		1.00004781139589, 5.89795498190949E-06,
		1.00004760982396, 5.87134383333083E-06,
		1.00004740957501, 5.84491577656417E-06,
		1.00004721063724, 5.81866911941997E-06,
		1.00004701299901, 5.79260218933098E-06,
		1.00004681664877, 5.76671333307869E-06,
		1.00004662157515, 5.74100091652426E-06,
		1.00004642776687, 5.71546332434382E-06,
		1.00004623521279, 0.000005690098959768,
		1.00004604390189, 5.66490624432577E-06,
		1.00004585382328, 5.63988361759234E-06,
		1.00004566496617, 5.61502953694109E-06,
		1.00004547731991, 5.59034247729959E-06,
		1.00004529087396, 5.56582093090939E-06,
		1.00004510561791, 5.54146340708975E-06,
		1.00004492154143, 5.51726843200509E-06,
		1.00004473863433, 5.49323454843614E-06,
		1.00004455688653, 5.46936031555473E-06,
		1.00004437628805, 5.44564430870213E-06,
		1.00004419682902, 5.4220851191709E-06,
		1.00004401849969, 5.39868135399018E-06,
		1.0000438412904, 5.37543163571433E-06,
		1.0000436651916, 5.35233460221493E-06,
		1.00004349019384, 5.32938890647597E-06,
		1.00004331628777, 5.30659321639232E-06,
		1.00004314346416, 5.28394621457125E-06,
		1.00004297171385, 5.26144659813707E-06,
		1.0000428010278, 5.23909307853887E-06,
		1.00004263139704, 5.21688438136107E-06,
		1.00004246281273, 5.19481924613708E-06,
		1.00004229526611, 5.17289642616568E-06,
		1.00004212874849, 5.15111468833033E-06,
		1.00004196325129, 5.12947281292116E-06,
		1.00004179876604, 5.10796959345975E-06,
		1.00004163528433, 5.08660383652654E-06,
		1.00004147279785, 5.06537436159093E-06,
		1.00004131129837, 5.04428000084386E-06,
		1.00004115077775, 5.02331959903304E-06,
		1.00004099122794, 5.00249201330059E-06,
		1.00004083264097, 4.98179611302315E-06,
		1.00004067500894, 4.96123077965445E-06,
		1.00004051832406, 4.94079490657018E-06,
		1.0000403625786, 4.92048739891521E-06,
		1.00004020776491, 4.90030717345309E-06,
		1.00004005387542, 4.88025315841783E-06,
		1.00003990090265, 4.86032429336783E-06,
		1.00003974883917, 4.84051952904206E-06,
		1.00003959767765, 4.82083782721827E-06,
		1.00003944741084, 4.80127816057339E-06,
		1.00003929803153, 4.78183951254597E-06,
		1.00003914953262, 4.7625208772006E-06,
		1.00003900190705, 4.74332125909438E-06,
		1.00003885514786, 4.72423967314534E-06,
		1.00003870924814, 4.70527514450275E-06,
		1.00003856420107, 4.68642670841937E-06,
		1.00003841999987, 4.66769341012553E-06,
		1.00003827663785, 4.64907430470508E-06,
		1.00003813410838, 4.63056845697308E-06,
		1.00003799240489, 4.61217494135534E-06,
		1.00003785152089, 4.59389284176963E-06,
		1.00003771144994, 4.57572125150866E-06,
		1.00003757218568, 4.55765927312471E-06,
		1.00003743372179, 4.53970601831592E-06,
		1.00003729605204, 4.52186060781423E-06,
		1.00003715917023, 4.50412217127491E-06,
		1.00003702307025, 4.48648984716767E-06,
		1.00003688774603, 4.46896278266931E-06,
		1.00003675319158, 4.45154013355794E-06,
		1.00003661940094, 4.43422106410862E-06,
		1.00003648636823, 4.41700474699058E-06,
		1.00003635408762, 4.3998903631658E-06,
		1.00003622255334, 4.38287710178906E-06,
		1.00003609175968, 4.36596416010944E-06,
		1.00003596170096, 4.34915074337311E-06,
		1.0000358323716, 4.33243606472755E-06,
		1.00003570376602, 4.31581934512711E-06,
		1.00003557587874, 4.29929981323985E-06,
		1.0000354487043, 4.2828767053557E-06,
		1.00003532223732, 4.26654926529591E-06,
		1.00003519647245, 4.25031674432371E-06,
		1.0000350714044, 4.2341784010563E-06,
		1.00003494702792, 4.21813350137793E-06,
		1.00003482333783, 4.20218131835428E-06,
		1.00003470032899, 4.18632113214798E-06,
		1.0000345779963, 4.17055222993528E-06,
		1.00003445633471, 4.1548739058239E-06,
		1.00003433533923, 4.13928546077195E-06,
	};

	bool newspc = true, jacatt = false, last;
	const unsigned mmax = 2003;
	unsigned nstsig = 0;
	const double tdir = xend - x > 0 ? 1. : -1.;
	const double hmax = tdir * (xend - x);
	const double facmax = 10;
	const double errpow = 0.5;
	double hmin = 10. * uround * fmax(fabs(x), hmax);
	double absh, h, abshold, est, sprad, wt, at, err, errold, fac, temp, ci;
	double w0, w1, b, c, d;
	unsigned i, m;

	double* yn = &work[0];
	double* fn = &work[n];
	double* vtemp1 = &work[2 * n];
	double* vtemp2 = &work[3 * n];

	double* eigvec = NULL;
	if (iwork[0] == 0)
	{
		eigvec = &work[4 * n];
	}

	double* swap, * res = y;

	memcpy(yn, y, n * sizeof(double));
	f(&n, &x, yn, fn);
	iwork[4]++;

	while (true)
	{
		if (newspc)
		{
			if (iwork[0] == 1)
			{
				rho(&n, &x, yn, &sprad);
			}
			else
			{
				sprad = mono_rho(n, x, f, yn, fn, vtemp1, vtemp2, eigvec, hmax, uround, iwork);
				if (sprad < 0)
				{
					return 6;
				}
			}
			jacatt = true;
		}

		if (iwork[5] == 0)
		{
			absh = hmax;
			if (sprad * absh > 1.)
			{
				absh = 1. / sprad;
			}
			absh = fmax(absh, hmin);

			for (i = 0; i < n; i++)
			{
				vtemp1[i] = yn[i] + absh * fn[i];
			}
			ci = x + absh;
			f(&n, &ci, vtemp1, vtemp2);
			iwork[4]++;

			est = 0.;
			at = atol[0];
			for (i = 0; i < n; i++)
			{
				if (iwork[3])
				{
					at = atol[i];
				}
				wt = at + rtol * fabs(yn[i]);
				if (wt == 0.)
				{
					return 3;
				}
				est += pow((vtemp2[i] - fn[i]) / wt, 2);
			}
			est = absh * sqrt(est / n);
			if (0.1 * absh < hmax * sqrt(est))
			{
				absh = fmax(0.1 * absh / sqrt(est), hmin);
			}
			else
			{
				absh = hmax;
			}
		}

		last = false;
		if (1.1 * absh >= fabs(xend - x))
		{
			absh = fabs(xend - x);
			last = true;
		}

		m = 1 + (unsigned)pow(2.33 * absh * sprad, 0.55);
		if (m < 3)
		{
			m = 3;
		}
		else if (m > mmax)
		{
			m = mmax;
			absh = pow(m, 1.8181818181818181) / (2.33 * sprad);
			last = false;
		}

		if (m <= 451)
		{
			i = 2 * (m - 3);
		}
		else if (m <= 903)
		{
			m += 1 - (m % 2);
			i = (m - 451) + 896;
		}
		else
		{
			m += 3 - (m % 4);
			i = (m - 903) / 2 + 1348;
		}
		w0 = coef[i];
		w1 = coef[i + 1];

		c = 0.5 / (m * w1 * (1 + cosh((m - 1) * acosh(w0))));
		d = c * m / (m - 2);
		b = d * (2 * m - 4) * w1;

		h = tdir * absh;
		step_mono(n, x, f, yn, fn, h, m, w0, w1, b, c, d, y, vtemp1, vtemp2);

		hmin = 10. * uround * fmax(fabs(x), fabs(x + h));
		iwork[9] = m > iwork[9] ? m : iwork[9];

		ci = x + h;
		f(&n, &ci, y, vtemp1);
		iwork[4] += m;
		iwork[5]++;

		err = 0.;
		at = atol[0];
		for (i = 0; i < n; i++)
		{
			if (iwork[3])
			{
				at = atol[i];
			}
			wt = at + rtol * fmax(fabs(y[i]), fabs(yn[i]));
			if (wt == 0)
			{
				return 3;
			}

			est = 0.1 * (yn[i] - y[i] + h * vtemp1[i]);
			err = err + pow(est / wt, 2);
		}
		err = sqrt(err / n);

		if (!isfinited(err))
		{
			return 4;
		}
		if (err > 1.)
		{
			iwork[7]++;

			absh *= 0.8 * pow(err, -errpow);
			if (absh < hmin)
			{
				return 4;
			}
			else
			{
				newspc = !jacatt;
				continue;
			}
		}

		if (iwork[2] == 1)
		{
			solout(n, x, x + h, y);
		}

		iwork[6]++;
		x += h;

		if (last)
		{
			if (res != y)
			{
				memcpy(res, y, n * sizeof(double));
			}
			return 1;
		}

		jacatt = iwork[1] == 1;
		nstsig = (nstsig + 1) % 25;
		if (iwork[0] == 1 || nstsig == 0)
		{
			newspc = !jacatt;
		}
		else
		{
			newspc = false;
		}

		swap = vtemp2;
		vtemp2 = fn;
		fn = vtemp1;
		vtemp1 = yn;
		yn = y;
		y = swap;

		fac = pow(err, -errpow);
		if (iwork[6] > 1)
		{
			temp = pow(errold, errpow) * fac * fac * absh / abshold;
			fac = fmin(fac, temp);
		}
		abshold = absh;
		absh *= fmax(0.1, fmin(0.8 * fac, facmax));
		absh = fmax(hmin, fmin(hmax, absh));
		errold = err;
	}
}


int mono(const unsigned n, const double x, const double xend, double* y,
	const FcnEqDiff f, const Rho rho, const SolTrait solout,
	const double* atol, const double rtol,
	unsigned iwork[10])
{
	const double uround = 1e-16;

	if (n <= 0 || atol[0] <= 0 || rtol < 10. * uround)
	{
		return 5;
	}

	if (iwork[3])
	{
		for (unsigned i = 1; i < n; i++)
		{
			if (atol[i] <= 0)
			{
				return 5;
			}
		}
	}

	iwork[4] = 0, iwork[5] = 0, iwork[6] = 0,
	iwork[7] = 0, iwork[8] = 0, iwork[9] = 0;

	unsigned long long work_length = 4;
	if (iwork[0] == 0)
	{
		work_length++;
	}
	double* work = (double*)malloc(work_length * n * sizeof(double));

	int idid = mono_core(n, x, xend, y, f, rho, solout, atol, rtol, uround, work, iwork);

	free(work);

	return idid;
}