//	Version of February 2025


#include "methods_common.h"


static double mono_rho(const unsigned n, const double x, const FcnEqDiff f,
	double* yn, double* fn, double* v, double* fv, double* eigvec,
	const double hmax, const double uround, unsigned iwork[10])
{
	const double safe = 1.2;
	const unsigned itmax = 50;
	const double sqrtu = sqrt(uround), small = 1. / hmax;
	double ynrm = 0., vnrm = 0., sprad, sigma, sigmal, dynrm, dfnrm;
	unsigned i, iter, index;

	if (iwork[5] == 0)
	{
		memcpy(v, fn, n * sizeof(double));
	}
	else
	{
		memcpy(v, eigvec, n * sizeof(double));
	}

	for (i = 0; i < n; i++)
	{
		ynrm += yn[i] * yn[i];
		vnrm += v[i] * v[i];
	}
	ynrm = sqrt(ynrm);
	vnrm = sqrt(vnrm);

	if (ynrm != 0.)
	{
		dynrm = ynrm * sqrtu;
		if (vnrm != 0.)
		{
			for (i = 0; i < n; i++)
			{
				v[i] = yn[i] + v[i] * (dynrm / vnrm);
			}
		}
		else
		{
			for (i = 0; i < n; i++)
			{
				v[i] = yn[i] + yn[i] * sqrtu;
			}
		}
	}
	else
	{
		dynrm = uround;
		if (vnrm != 0.)
		{
			dynrm = uround;
			for (i = 0; i < n; i++)
			{
				v[i] *= (dynrm / vnrm);
			}
		}
		else
		{
			for (i = 0; i < n; i++)
			{
				v[i] = dynrm;
			}
		}
	}

	sigma = 0.;
	for (iter = 1; iter <= itmax; iter++)
	{
		f(&n, &x, v, fv);
		iwork[8]++;
		dfnrm = 0.;
		for (i = 0; i < n; i++)
		{
			dfnrm += pow(fv[i] - fn[i], 2);
		}
		dfnrm = sqrt(dfnrm);
		sigmal = sigma;
		sigma = dfnrm / dynrm;
		sprad = safe * sigma;

		if (iter >= 2 && fabs(sigma - sigmal) <= 0.01 * fmax(sigma, small))
		{
			for (i = 0; i < n; i++)
			{
				eigvec[i] = v[i] - yn[i];
			}
			return sprad;
		}

		if (dfnrm != 0.)
		{
			for (i = 0; i < n; i++)
			{
				v[i] = yn[i] + (fv[i] - fn[i]) * (dynrm / dfnrm);
			}
		}
		else
		{
			index = 1 + iter % n;
			v[index] = yn[index] - (v[index] - yn[index]);
		}
	}

	return -1;
}


static void step_mono(const unsigned n, const double x, const FcnEqDiff f,
	const double* yn, const double* fn, const double h, 
	const unsigned m, const double acoshw0, const double w1,
	const double b, const double c, const double d,
	double* y, double* yjm1, double* yjm2)
{
	unsigned i;
	double* swap, * res = y;

	memcpy(yjm2, yn, n * sizeof(double));

	const double w0 = cosh(acoshw0);

	double bjm1 = 1. / (1. + w0), bjm2 = 0.5;
	double mus = w1 * bjm1;
	for (i = 0; i < n; i++)
	{
		yjm1[i] = yn[i] + h * mus * fn[i];
	}
	
	double thjm2 = 0., thjm1 = mus, thj;
	double zjm1 = w0, zj, bj, ajm1, mu, nu, cj, bjdbjm1, onemmumnu;
	for (unsigned j = 2; j <= m; j++)
	{
		zj = cosh(j * acoshw0);
		bj = 1. / (1. + zj);
		bjdbjm1 = bj / bjm1;
		mu = 2. * w0 * bjdbjm1;
		nu = -bj / bjm2;
		mus = 2. * w1 * bjdbjm1;
		ajm1 = 1. - zjm1 * bjm1;
		onemmumnu = 1. - mu - nu;

		cj = x + h * thjm1;
		f(&n, &cj, yjm1, y);
		for (i = 0; i < n; i++)
		{
			y[i] = mu * yjm1[i] + nu * yjm2[i] + onemmumnu * yn[i] + h * mus * (y[i] - ajm1 * fn[i]);
		}
		thj = mu * thjm1 + nu * thjm2 + mus * (1. - ajm1);

		if (j < m)
		{
			swap = yjm2;
			yjm2 = yjm1;
			yjm1 = y;
			y = swap;

			thjm2 = thjm1;
			thjm1 = thj;
			bjm2 = bjm1;
			bjm1 = bj;
			zjm1 = zj;
		}
	}

	mu = c / bj;
	nu = -d / bjm2;
	onemmumnu = 1. - mu - nu;
	for (i = 0; i < n; i++)
	{
		res[i] = onemmumnu * yn[i] + mu * y[i] + nu * yjm2[i] + b * h * fn[i];
	}
}


static int mono_core(const unsigned n, double x, const double xend, double* y,
	const FcnEqDiff f, const Rho rho, const SolTrait solout,
	const double* atol, const double rtol, const double uround,
	double* work, unsigned iwork[10])
{
	const double coef[1900] =
	{
		0.7062321904146185424,0.62996052494743658238,
		1.0636996533006792379,0.46179955742349741356,
		0.9548161067606468926,0.28907833706496496895,
		0.8787474577307363673,0.20424294671264756237,
		0.7955809664681358685,0.14954038989882685334,
		0.7339518707962884088,0.1158733753896629802,
		0.6764301657372331004,0.091968610091929451633,
		0.6309448028541855464,0.075363337469537077087,
		0.5892710415084050885,0.06274243841593997133,
		0.5548592841359078803,0.053307898493517000555,
		0.5232849393690487334,0.045796004705078360307,
		0.4964146753619779296,0.039899016480715297183,
		0.4716232642085839744,0.035045137638647152855,
		0.4500546793213299451,0.031099504630741598521,
		0.4300338398743745285,0.027770216039149601492,
		0.412320382789506154,0.024992349852874048777,
		0.3957844892975339097,0.022602975293382428227,
		0.3809596697102613431,0.020568568836684281153,
		0.3670499295655778095,0.018791726795320291283,
		0.3544458723008952135,0.017254198228845965041,
		0.3425666805879202805,0.015894500074286121353,
		0.3317076926190908831,0.014702293249701156592,
		0.3214327223202958903,0.013637018768319483638,
		0.3119709122876586981,0.012692647245089481816,
		0.3029867216935111395,0.011841428790288600702,
		0.2946617411443100294,0.011079778188809195971,
		0.2867325404918130964,0.010388118043943199087,
		0.2793456042734585009,0.0097642950126498808442,
		0.2722904703692313746,0.0091941315495400142292,
		0.2656871046475187066,0.0086763351224198723609,
		0.2593647961940550441,0.0082004045860011524987,
		0.2534230838512169289,0.0077655754193732236911,
		0.2477216521390754611,0.0073639153125520070528,
		0.2423440374909787246,0.0069949884407378408381,
		0.237173551175985762,0.006652698643942282237,
		0.232281007357408387,0.0063368166621806282811,
		0.2275683519403135084,0.0060425853162554805598,
		0.2230961523351851666,0.005769905641305700972,
		0.2187812437635080351,0.0055150144094316055242,
		0.2146758448308831076,0.0052778945804608635712,
		0.2107088268655261763,0.0050555325860851534005,
		0.2069255353472723824,0.004847962261189261265,
		0.2032646740116142412,0.004652743595917211238,
		0.1997658770778501708,0.0044699411938983108,
		0.1963759573379518619,0.0042975595859229638293,
		0.1931297629585826096,0.0041356810562736231243,
		0.1899808527613585666,0.0039826587557469857138,
		0.1869600332215592543,0.003838584119165066545,
		0.1840265199702971161,0.0037020866438844207896,
		0.1812076822869834281,0.0035732613760211976061,
		0.1784675139290638375,0.0034509590340102717851,
		0.1758304421144657994,0.0033352747144432372759,
		0.1732645236969866502,0.0032252378364794666187,
		0.170791652596897411,0.0031209413025611473744,
		0.1683833622216963703,0.0030215600944663659796,
		0.1660593531132924712,0.0029271835542444020301,
		0.1637941505039642142,0.0028371061525072964243,
		0.1616055461331633671,0.0027514128909747749958,
		0.1594706536999201026,0.0026694970313654028647,
		0.1574055958755145491,0.002591438845138099979,
		0.1553897370197119188,0.0025167138193286316134,
		0.1534377338706180066,0.0024453973625139073059,
		0.1515309168439285733,0.0023770338263566654683,
		0.1496826498034392852,0.0023116937911829304799,
		0.1478759880933353075,0.0022489796201920883464,
		0.1461231508886534973,0.0021889572060984868625,
		0.1444087130963941226,0.0021312780482538252473,
		0.1427438766950292178,0.002076003556769451066,
		0.1411145603834423598,0.0020228270633301484559,
		0.1395310591234625579,0.0019718057365995148712,
		0.1379804842664553915,0.0019226686944578857588,
		0.1364723193776520267,0.0018754691224201342885,
		0.1349947379327670153,0.0018299668916243707621,
		0.1335564954146914398,0.0017862114672321036727,
		0.1321467142302843814,0.0017439892620723590406,
		0.1307734946450313701,0.0017033462799843501604,
		0.1294268094532007736,0.00166409193373069429,
		0.1281141676556466741,0.0016262690158612089949,
		0.1268263063266474049,0.0015897069465916921567,
		0.1255701995222583851,0.0015544455450662779702,
		0.1243372730924159395,0.001520331699298885522,
		0.1231340159049286873,0.001487402479037043987,
		0.1219524761580213527,0.0014555200756273263638,
		0.1207987016230224202,0.0014247190187964530404,
		0.1196653042198321297,0.0013948749511083491117,
		0.1185579298082582473,0.0013660200568990533662,
		0.117469702132018882,0.0013380418390518325512,
		0.1164059000596142091,0.0013109703167065216994,
		0.1153601130852350859,0.0012847034815678789013,
		0.1143372842875380773,0.0012592693539148042353,
		0.1133314278965617237,0.0012345752278128869543,
		0.1123471791498705438,0.0012106472778908015853,
		0.1113789404064259986,0.0011874010707845152264,
		0.1104310641579413156,0.0011648610763769671894,
		0.1094983081376070507,0.0011429502372345585325,
		0.1085847646761290381,0.0011216914479440574419,
		0.107685517502866419,0.0011010142439306183515,
		0.1068044191578303307,0.0010809400633297607221,
		0.1059368529565498513,0.0010614043485527922583,
		0.1050864500600410228,0.0010424271903513945568,
		0.1042488695759511655,0.0010239493357137797492,
		0.1034275379614126594,0.0010059896280878098572,
		0.1026183686336953132,0.00098849358852445167594,
		0.1018245984777430879,0.00097147890500540571062,
		0.1010423757855979539,0.00095489540424823599523,
		0.100274761626825112,0.00093875970305964548513,
		0.099518121551572944,0.00092302551925440556164,
		0.098775353343372908,0.00090770847585423702867,
		0.098043023811947939,0.00089276581397449627348,
		0.097323878885959169,0.00087821223393608154798,
		0.096614672079439748,0.00086400817311093873034,
		0.095918007912816246,0.00085016747444433784813,
		0.095230813339197753,0.00083665348012019458716,
		0.094555561033033959,0.00082347923577525034762,
		0.093889339276696035,0.00081061072813618598425,
		0.093234497664986497,0.0007980602607978681427,
		0.092588274736622311,0.00078579623212747891047,
		0.091952905055448959,0.00077383025456164195264,
		0.091325767275916481,0.00076213292928527995654,
		0.090708988331404434,0.00075071522445762638646,
		0.090100077691283643,0.00073954975649303787449,
		0.08950106147247815,0.00072864689249748827799,
		0.088909571416285662,0.0007179810952925513865,
		0.088327539105667462,0.00070756217081309993294,
		0.087752710695867272,0.00069736627608506023748,
		0.087186929035899181,0.00068740269269855947489,
		0.08662804745720218,0.00067764913442897473311,
		0.08607782543621832,0.00066811439255237920961,
		0.085534216805307073,0.0006587776132516102703,
		0.084998902630328433,0.00064964712896018937128,
		0.084469931080180722,0.00064070340560764387974,
		0.083948909407959989,0.0006319543459122469456,
		0.0834339744194619,0.00062338163331438262411,
		0.082926663820305267,0.00061499276779568559479,
		0.082425197776915509,0.00060677055739186853858,
		0.081931048408665864,0.00059872212435568891804,
		0.081442514352579873,0.000590831316749743658,
		0.080961005824630806,0.00058310490229667200924,
		0.080484895395248579,0.00057552769200549375389,
		0.080015534804639873,0.0005681061206058432361,
		0.07955136634221052,0.00056082589170090177064,
		0.079093686465773966,0.0005536931270370009372,
		0.078641003264910697,0.00054669435851425311985,
		0.078194560893125166,0.00053983541350032873966,
		0.077752929592489765,0.00053310359335258896983,
		0.077317303992196103,0.00052650444837121039668,
		0.076886313088069773,0.00052002599545745319184,
		0.076461104582515082,0.00051367352396352658477,
		0.076040363055227006,0.00050743571687448653593,
		0.075625191711076003,0.00050131761761545467387,
		0.075214327754372727,0.0004953085298264259978,
		0.074808832166360237,0.00048941326501264707293,
		0.074407492010785887,0.00048362170569441736321,
		0.074011328175605421,0.00047793844452836296586,
		0.073619174997840275,0.00047235390445731682559,
		0.073232015269683206,0.00046687247149569217047,
		0.072848728180569537,0.00046148507356563131701,
		0.072470260301459911,0.0004561959014460143604,
		0.072095533406140907,0.00045099635533830722369,
		0.071725459604863039,0.00044589044145248367205,
		0.07135900112908308,0.00044087000206876024192,
		0.070997037283082046,0.00043593886880950351524,
		0.07063856876025334,0.00043108929811309153201,
		0.070284443615410345,0.00042632495636047759987,
		0.069933699129549616,0.00042163848830985721243,
		0.069587153573202084,0.00041703340385798244106,
		0.069243879053288291,0.00041250271214834085462,
		0.068904665436284478,0.00040804977480410289471,
		0.068568617997990231,0.0004036679431621355132,
		0.06823649950194564,0.000399360438275040517,
		0.067907446833056259,0.00039512093307793498558,
		0.067582196879318882,0.00039095251528413964793,
		0.067259916665478308,0.00038684916029659607423,
		0.06694131836261585,0.00038281382928195331967,
		0.066625597750331888,0.00037884078232548653192,
		0.066313443377230324,0.00037493286043156309502,
		0.06600407847133638,0.00037108459181850408118,
		0.0656981689932487,0.00036729870333265848647,
		0.06539496438625842,0.00036356997591348585079,
		0.065095109001368028,0.00035990102789938179651,
		0.064797877332375641,0.00035628687858650003736,
		0.064503893046643154,0.00035273004312509702622,
		0.064212454587618365,0.00034922576576913737738,
		0.063924165815865719,0.00034577646349243469847,
		0.063638348083369768,0.00034237759299876168108,
		0.063355586274723499,0.0003390314778095372543,
		0.063075223665234334,0.00033573377539305365006,
		0.062797826951202558,0.0003324867202736792912,
		0.062522760398383704,0.00032928615975936876542,
		0.062250573261980008,0.00032613424358162406533,
		0.061980649914361102,0.00032302699866667253571,
		0.061713522878814908,0.00031996649392243147662,
		0.061448595796473292,0.00031694892632332967392,
		0.06118638513218129,0.00031397628770315477488,
		0.060926313001124771,0.00031104493611799699671,
		0.06066888044960296,0.00030815678987113107551,
		0.060413527312654823,0.00030530835969346978738,
		0.060160739826346518,0.00030250149370854115401,
		0.059909974829426105,0.00029973284743470528399,
		0.059661704326308778,0.0002970042019857253312,
		0.059415401479085253,0.00029431235026252501037,
		0.059171524611099135,0.0002916590093695170206,
		0.058929562561073172,0.00028904110263379507627,
		0.058689960495467835,0.00028646028599170214192,
		0.058452222314606584,0.00028391360665730244012,
		0.058216780527368849,0.0002814026620907272871,
		0.057983153510484285,0.00027892461724217605962,
		0.057751761591072365,0.0002764810136470476513,
		0.057522137065192464,0.00027406912820262534142,
		0.057294688531857769,0.00027169044893910321668,
		0.057068961675894495,0.00026934235924905593498,
		0.056845353800924398,0.0002670262959529060558,
		0.056623423474992543,0.00026473974380133844768,
		0.056403557119255144,0.00026248409058367309204,
		0.056185325703042141,0.00026025691756520592035,
		0.05596910515925793,0.00025805956557290090251,
		0.055754478398887115,0.00025588970781749161433,
		0.055541811243092863,0.00025374864012880011267,
		0.055330698105961723,0.00025163412335023513917,
		0.055121495056669168,0.00024954741018212946464,
		0.054913807593780075,0.00024748634502762272099,
		0.05470798237836629,0.00024545213923323208954,
		0.054503635593700412,0.00024344271691332276477,
		0.054301104821598447,0.00024145924974951322819,
		0.054100016548114166,0.00023949973792906331762,
		0.053900699590401812,0.0002375653150757404266,
		0.053702790372267267,0.00023565405400830277356,
		0.053506609247278819,0.0002337670518224217296,
		0.053311802227974364,0.00023190245071159537284,
		0.053118681492585295,0.00023006131270014944842,
		0.052926902308535848,0.00022824184627277229404,
		0.052736768954793417,0.00022644507977020902526,
		0.052547945634213079,0.00022466928504736860619,
		0.052360728991007353,0.00022291545808396447045,
		0.052174791857659437,0.00022118193133684512663,
		0.051990423497149058,0.00021946966968556192435,
		0.051807305078743872,0.00021777706356409952224,
		0.051625718727269304,0.00021610504795435743824,
		0.051445353668239909,0.00021445206877754832002,
		0.051266485121474016,0.00021281903226518882632,
		0.051088810099886691,0.00021120443746270487461,
		0.05091259714198833,0.00020960916294618773982,
		0.050737550790359896,0.0002080317586416904467,
		0.050563933116910965,0.00020647307651527900532,
		0.050391455946719374,0.00020493171524250783626,
		0.050220375091239462,0.00020340850117785065643,
		0.050050409420927355,0.00020190207972118986805,
		0.049881808684772862,0.00020041325256930984975,
		0.04971429857105617,0.00019894070992111784399,
		0.049548122956522658,0.00019748522972737594535,
		0.049383014128827791,0.00019604554515489638717,
		0.049219210275285346,0.0001946224112800105732,
		0.049056450073149293,0.00019321460249517864372,
		0.04889496619605098,0.00019182285183585287509,
		0.048734503509328561,0.00019044597326176661181,
		0.04857528934194166,0.0001890846785649230096,
		0.048417074553673546,0.00018773781969317182156,
		0.048260081291392186,0.00018640608795818452928,
		0.048104066223195956,0.00018508837179161750997,
		0.047949246470302142,0.00018378534275532193223,
		0.047795384330156781,0.00018249592433120011268,
		0.047642692048904592,0.00018122076903079860537,
		0.047490937381206395,0.00017995883401961015172,
		0.047340327843111433,0.00017871075342891711853,
		0.047190636480886378,0.00017747551680444483273,
		0.047042066220109354,0.00017625374053921259612,
		0.046894395239273621,0.00017504444531573088591,
		0.04674782200799334,0.00017384823040407451908,
		0.046602129683559847,0.00017266414643682005674,
		0.046457512409236815,0.00017149277615101629558,
		0.046313758173371439,0.00017033319899632451973,
		0.046171056917808915,0.00016918598174249848269,
		0.0460292013196455,0.00016805023157422841234,
		0.045888377239760014,0.00016692649983666357155,
		0.045748381906888352,0.00016581392041574746486,
		0.045609397217106638,0.00016471302975276044106,
		0.045471224818652379,0.00016362298744691389858,
		0.045334042754856267,0.00016254431553542739561,
		0.045197656966076173,0.00016147619838624072765,
		0.045062241751021268,0.00016041914411236637603,
		0.044927607219341445,0.0001593723609471704807,
		0.044793924029479507,0.00015833634354027953364,
		0.044661006341908157,0.00015731032312634013181,
		0.044529021275546849,0.00015629478133425477408,
		0.044397786927396809,0.00015528897157299850914,
		0.044267466974134094,0.00015429336287608084971,
		0.044137883338993875,0.000153307230035196297,
		0.044009196350367652,0.00015233102989724669972,
		0.043881231651262986,0.00015136405787863349389,
		0.043754146312559738,0.00015040675903263547499,
		0.043627769594250685,0.00014945844867429624124,
		0.043502255397419863,0.00014851956044116238731,
		0.04337743649978143,0.00014758942885124558949,
		0.043253463717405091,0.00014666847648982843258,
		0.04313017324984203,0.000145756056411136211,
		0.043007712910111858,0.00014485258049787029864,
		0.042885922226960874,0.00014395741970124440124,
		0.042764946089617222,0.00014307097553788143337,
		0.042644627266492224,0.00014219263624297294171,
		0.042525107799682092,0.00014132279329096128989,
		0.042406233610720393,0.00014046085161297646339,
		0.042288143968733505,0.00013960719295312007841,
		0.042170687864703019,0.00013876123837421570883,
		0.042054001866547191,0.00013792336019032576653,
		0.041937937953776702,0.00013709299505440333907,
		0.041822630062555677,0.00013627050613972934404,
		0.041707933082652134,0.00013545534516944840257,
		0.041593978385710869,0.00013464786645474421173,
		0.041480623696029493,0.00013384753628964195518,
		0.041367997885833665,0.0001330547003917866174,
		0.04125596144066832,0.00013226883914645322124,
		0.041144640796386412,0.00013149028993660695026,
		0.041033899128849312,0.00013071854677792469525,
		0.040923860498607233,0.00012995393896825697569,
		0.040814390703168562,0.00012919597371076623944,
		0.040705611486948196,0.0001284449724588462622,
		0.04059739120260766,0.00012770045517735303226,
		0.040489849335762128,0.00012696273570734260114,
		0.040382856729825794,0.00012623134636593062672,
		0.040276530667185541,0.00012550659360576659016,
		0.040170744419622617,0.00012478802170242281399,
		0.040065613120167645,0.0001240759299362201562,
		0.039961012408523043,0.00012336987416232485193,
		0.039857055320597821,0.00012267014669727301341,
		0.039753619805437516,0.00012197631461124627909,
		0.039650816852486171,0.00012128866345831024147,
		0.039548526663353435,0.00012060677117274433255,
		0.039446858230153909,0.0001199309167405186581,
		0.039345693952015532,0.00011926068862216124092,
		0.039245140871392377,0.00011859635942325975309,
		0.039145083531554963,0.00011793752780524666534,
		0.03904562707155138,0.00011728446017464293213,
		0.038946658127028729,0.0001166367650804105866,
		0.038848279978519369,0.0001159947029051749538,
		0.038750381303832821,0.00011535789178351223894,
		0.038653063568559702,0.00011472658624341997494,
		0.038556217443954162,0.00011410041371414750883,
		0.038459942622968868,0.00011347962303265977994,
		0.038364131723028016,0.00011286385064245077001,
		0.038268882705524101,0.00011225333984759576867,
		0.038174090088169019,0.00011164773583547761994,
		0.038079850140689271,0.00011104727653018331567,
		0.037986059236545459,0.00011045161560228260888,
		0.03789281199254937,0.0001098609857437353743,
		0.037800006594667763,0.00010927504885685099017,
		0.037707736044445185,0.00010869403254447585512,
		0.037615900298363457,0.00010811760669808593355,
		0.037524590779281072,0.00010754599396976452054,
		0.037433709173412082,0.00010697887200609269023,
		0.037343345360479886,0.00010641645864225405481,
		0.037253402716814737,0.00010585843905403902125,
		0.037163969613560299,0.00010530502638927673285,
		0.037074951078673997,0.00010475591313490693612,
		0.036986434008312806,0.0001042113078767928507,
		0.036898325044661048,0.00010367091020248456292,
		0.036810709641551738,0.0001031349242572659194,
		0.036723496019047848,0.00010260305652597890107,
		0.036636768220421601,0.00010207550683086067437,
		0.036550436008283105,0.00010155198835766040516,
		0.036464582046236978,0.00010103269671938932291,
		0.03637911760509176,0.00010051735161297891525,
		0.036294123998836115,0.00010000614455245924062,
		0.036209513973078522,0.000099498801562617481707,
		0.036125367521429173,0.000098995510165301628695,
		0.036041598831816843,0.000098496002535976222512,
		0.035958286605922909,0.000098000462307785543909,
		0.03587534644240549,0.000097508627635602581181,
		0.03579285577870433,0.000097020678364145294479,
		0.03571073159347563,0.00009653635846210730396,
		0.035629050086866596,0.000096055844082971533745,
		0.035547729587632037,0.000095578884849127199453,
		0.035466845084861132,0.00009510565331703755188,
		0.035386316228312745,0.000094635904607916351962,
		0.035306216821560578,0.00009416980777255233062,
		0.035226467807052072,0.000093707123281166996499,
		0.035147141827717837,0.000093248016767450950455,
		0.0350681610911326,0.000092792253905679789864,
		0.034989597103807095,0.000092339996998350982915,
		0.034911373311612261,0.000091891016783520785474,
		0.034833560108233237,0.000091445472315820617937,
		0.03475608215171324,0.000091003139261319093649,
		0.034679008745896663,0.00009056417350762052002,
		0.034602265735559963,0.00009012835551737503416,
		0.034525921357101002,0.00008969583808959682564,
		0.034449902617253921,0.000089266406356263611435,
		0.034374276706791756,0.000088840210103917334327,
		0.034298971770273601,0.000088417039010632409381,
		0.034224053974114347,0.000087997039924356849831,
		0.034149452577188235,0.000087580006949906554136,
		0.034075232742280523,0.000087166084068350836651,
		0.03400132481967454,0.000086755069695626268479,
		0.033927792988732518,0.000086347105015549108799,
		0.033854568668826047,0.000085941992643154778134,
		0.033781715075594743,0.000085539871032613198007,
		0.033709164675745022,0.000085140546889505962443,
		0.03363697974040323,0.000084744156004012391299,
		0.033565093762407364,0.000084350509067052202695,
		0.033493568087103403,0.000083959739268584214624,
		0.033422337212791253,0.000083571661182883401427,
		0.033351461577307112,0.000083186405461635400108,
		0.033280876664260674,0.000082803790463598154349,
		0.033210642021800243,0.000082423944362369137331,
		0.033140694099195266,0.000082046689205317580412,
		0.033071091572292511,0.000081672150746433700555,
		0.033001771836858297,0.000081300154628721380639,
		0.032932792713401398,0.000080930824243396388843,
		0.032864092525494863,0.000080563988738914326985,
		0.032795728254862479,0.000080199769198955138106,
		0.032727639134652709,0.000079837998189939601358,
		0.032659881323958692,0.000079478794541708185433,
		0.032592394947718361,0.000079121994153763233755,
		0.032525235358161358,0.000078767713654309807533,
		0.032458343554661532,0.000078415792193561347337,
		0.032391774097976066,0.000078066344248847436429,
		0.032325468844981016,0.000077719212141149026515,
		0.03225948157998676,0.00007737450824628239536,
		0.032193755000845562,0.000077032077978396399743,
		0.032128342130091622,0.000076692031659803113692,
		0.032063186490423422,0.000076354217722483988734,
		0.031998340356924604,0.000076018744481945988065,
		0.031933748061394542,0.000075685463314855536504,
		0.031869461145456637,0.00007535448057534507379,
		0.031805424734639548,0.000075025650513732403005,
		0.031741689650770819,0.000074699077566977530267,
		0.031678201798099921,0.000074374618790059223721,
		0.03161501129200606,0.000074052376745777221102,
		0.031552064800803935,0.000073732211226755876912,
		0.031489411746463856,0.000073414222963494096668,
		0.031426999547053147,0.000073098274421155912093,
		0.031364876943873079,0.000072784464538681976744,
		0.031302992090764403,0.000072472658390516468015,
		0.031241393060807846,0.000072162953163702115271,
		0.031180028729962509,0.000071855216480489364245,
		0.031118946515253681,0.000071549543814634479395,
		0.03105809600141889,0.000071245805276447497437,
		0.030997523961317401,0.000070944094663993021416,
		0.03093718067543172,0.000070644284517564921676,
		0.030877112284076276,0.000070346466996145374944,
		0.030817269750743169,0.000070050517013553051694,
		0.030757698594562191,0.000069756525125341375119,
		0.030698350449589571,0.000069464368563959307497,
		0.030639270224876681,0.000069174136316258595883,
		0.030580410212880457,0.000068885707879938227664,
		0.030521814723432861,0.000068599170706976723784,
		0.030463436695502531,0.000068314406508408624651,
		0.030405319850320405,0.000068031501234296055458,
		0.03034741776174483,0.000067750338758513746583,
		0.030289773572789856,0.000067471003561318722478,
		0.030232341480841402,0.000067193381630304653735,
		0.030118196122627991,0.000066643414745570121179,
		0.030004970153309328,0.000066100320280739348621,
		0.029892652231333736,0.0000655639829017866005,
		0.029781231203371883,0.000065034289701069620139,
		0.029670696100396607,0.000064511130136036266583,
		0.029561036133860861,0.000063994395969736317387,
		0.0294522406919709,0.000063483981213077769928,
		0.029344299336051953,0.000062979782068769262834,
		0.029237201797003698,0.000062481696876892432407,
		0.029130937971842943,0.000061989626062050120865,
		0.02902549792033103,0.000061503472082038367988,
		0.028920871861683517,0.000061023139377992049378,
		0.028817050171359816,0.000060548534325955876677,
		0.028714023377930502,0.000060079565189834251406,
		0.028611782160020118,0.000059616142075675167991,
		0.02851031734332334,0.000059158176887244996185,
		0.028409619897692458,0.000058705583282852541697,
		0.028309680934294172,0.000058258276633382289221,
		0.028210491702833797,0.000057816173981498177038,
		0.028112043588844988,0.000057379194001980639675,
		0.028014328111043206,0.000056947256963160987135,
		0.027917336918741156,0.000056520284689418468524,
		0.027821061789324516,0.000056098200524706596677,
		0.027725494625786304,0.000055680929297076490863,
		0.02763062745431831,0.000055268397284166128915,
		0.027536452421958041,0.000054860532179625490142,
		0.027442961794289677,0.000054457263060448618054,
		0.027350147953197622,0.000054058520355184639077,
		0.027258003394671205,0.000053664235813000741745,
		0.027166520726659208,0.000053274342473571051979,
		0.027075692666972882,0.000052888774637766235639,
		0.026985512041236174,0.0000525074678391195209,
		0.026895971780881928,0.000052130358816045661754,
		0.026807064921192862,0.00005175738548479016134,
		0.026718784599386136,0.000051388486913086841159,
		0.026631124052740402,0.000051023603294502580821,
		0.026544076616764217,0.000050662675923448763943,
		0.026457635723404763,0.000050305647170839650339,
		0.026371794899295837,0.000049952460460378553737,
		0.026286547764044106,0.000049603060245453339063,
		0.026201888028552649,0.000049257391986623364671,
		0.026117809493380846,0.000048915402129680583936,
		0.026034306047139684,0.000048577038084268088025,
		0.025951371664921599,0.000048242248203039918496,
		0.025869000406763975,0.000047910981761346505301,
		0.025787186416145471,0.000047583188937430593721,
		0.025705923918514343,0.000047258820793119013373,
		0.025625207219847973,0.000046937829254996114501,
		0.025545030705242845,0.000046620167096045151954,
		0.025465388837534187,0.000046305787917744336243,
		0.025386276155944584,0.000045994646132604694469,
		0.025307687274760827,0.000045686696947137292338,
		0.025229616882038321,0.000045381896345237762549,
		0.025152059738332388,0.000045080201071976465017,
		0.025075010675455791,0.000044781568617782971337,
		0.024998464595261872,0.000044485957203013919991,
		0.024922416468452674,0.00004419332576289363063,
		0.024846861333411447,0.000043903633932817195756,
		0.024771794295058964,0.00004361684203400608673,
		0.024697210523733071,0.000043332911059506618696,
		0.024623105254090931,0.000043051802660521916123,
		0.024549473784033408,0.000042773479133068307644,
		0.024476311473651095,0.000042497903404947356107,
		0.02440361374419145,0.000042225039023024997547,
		0.024331376077046569,0.000041954850140809521569,
		0.024259594012761099,0.000041687301506320375718,
		0.024188263150059835,0.000041422358450240018032,
		0.024117379144894534,0.000041159986874341275625,
		0.024046937709509518,0.0000409001532401828929,
		0.023976934611525607,0.000040642824558066171338,
		0.023907365673042,0.000040387968376245813877,
		0.023838226769755657,0.000040135552770388291,
		0.023769513830097804,0.000039885546333271243084,
		0.02370122283438717,0.000039637918164717624489,
		0.023633349813999575,0.000039392637861758479551,
		0.023565890850553499,0.000039149675509018419374,
		0.023498842075111271,0.000038909001669318041168,
		0.023432199667395541,0.000038670587374487699199,
		0.023365959855020679,0.000038434404116387198332,
		0.023300118912738769,0.000038200423838126137849,
		0.023234673161699893,0.000037968618925479784902,
		0.023169618968726364,0.000037738962198495503835,
		0.023104952745600616,0.00003751142690328490975,
		0.023040670948366452,0.000037285986703997052398,
		0.022976770076643344,0.000037062615674968069756,
		0.022913246672953521,0.000036841288293042879779,
		0.02285009732206154,0.000036621979430064603884,
		0.0227873186503261,0.000036404664345527536849,
		0.022724907325063807,0.000036189318679389595182,
		0.022662860053924648,0.000035975918445040289723,
		0.022601173584278922,0.000035764440022420378426,
		0.02253984470261537,0.000035554860151289462048,
		0.022478870233950285,0.000035347155924637888957,
		0.02241824704124735,0.000035141304782239435572,
		0.022357972024847986,0.000034937284504341326199,
		0.022298042121911986,0.000034735073205488250275,
		0.022238454305868217,0.000034534649328477126442,
		0.022179205585875181,0.000034335991638439451485,
		0.022120293006291223,0.000034139079217048158129,
		0.022061713646154189,0.000033943891456845989011,
		0.022003464618670341,0.000033750408055692475025,
		0.021945543070712323,0.000033558609011326684621,
		0.021887946182326009,0.000033368474616042986741,
		0.021830671166246033,0.000033179985451477143882,
		0.021773715267419833,0.000032993122383500123391,
		0.021717075762540029,0.000032807866557217084586,
		0.021660749959584972,0.000032624199392069066761,
		0.021604735197367284,0.000032442102577034968582,
		0.021549028845090239,0.000032261558065931472917,
		0.02149362830191182,0.000032082548072808632823,
		0.021438530996516303,0.000031905055067438894311,
		0.021383734386693202,0.000031729061770897389616,
		0.021329235958923447,0.000031554551151231391174,
		0.021275033227972632,0.000031381506419216871331,
		0.021221123736491205,0.00003120991102420016602,
		0.021167505054621457,0.000031039748650022792376,
		0.021114174779611164,0.000030871003211027520489,
		0.021061130535433776,0.000030703658848143848238,
		0.021008369972414998,0.000030537699925051075629,
		0.02095589076686565,0.000030373111024417221019,
		0.02090369062072068,0.000030209876944212066437,
		0.020851767261184213,0.000030047982694092662652,
		0.020800118440380509,0.000029887413491859666891,
		0.020748741935010728,0.000029728154759982927219,
		0.020697635546015377,0.000029570192122194767478,
		0.020646797098242335,0.000029413511400149465491,
		0.020596224440120352,0.000029258098610147454991,
		0.020545915443337907,0.000029103939959922818368,
		0.02049586800252733,0.00002895102184549267302,
		0.020446080034954086,0.000028799330848067088757,
		0.020396549480211119,0.000028648853731018207431,
		0.020347274299918161,0.000028499577436907268748,
		0.02029825247742592,0.000028351489084568278133,
		0.020249482017525037,0.000028204575966247083531,
		0.020200960946159742,0.000028058825544794658204,
		0.020152687310146102,0.000027914225450913415954,
		0.020104659176894793,0.00002777076348045541376,
		0.020056874634138297,0.000027628427591771324612,
		0.020009331789662444,0.000027487205903109090366,
		0.019962028771042231,0.000027347086690061190759,
		0.019914963725381814,0.000027208058383059490357,
		0.019868134819058623,0.000027070109564916650096,
		0.0198215402374715,0.000026933228968413114377,
		0.019775178184792811,0.000026797405473928708285,
		0.019729046883724426,0.000026662628107117902473,
		0.019683144575257533,0.000026528886036627825668,
		0.019637469518436186,0.000026396168571858126534,
		0.019592019990124537,0.00002626446516076180785,
		0.019546794284777677,0.000026133765387686176621,
		0.019501790714216022,0.00002600405897125307388,
		0.019457007607403181,0.000025875335762277567528,
		0.019412443310227247,0.000025747585741724310642,
		0.019368096185285435,0.000025620799018700786292,
		0.01932396461167203,0.00002549496582848667801,
		0.019280046984769563,0.000025370076530598622695,
		0.01923634171604317,0.000025246121606889619954,
		0.019192847232838082,0.000025123091659682388589,
		0.019149561978180171,0.000025000977409935977298,
		0.019106484410579518,0.000024879769695444952549,
		0.019063613003836945,0.000024759459469070502073,
		0.019020946246853442,0.00002464003779700280754,
		0.018978482643442471,0.00002452149585705405471,
		0.018936220712145058,0.000024403824936981463685,
		0.018894158986047659,0.000024287016432839735879,
		0.018852296012602728,0.000024171061847362327976,
		0.018810630353451951,0.000024055952788370976419,
		0.018769160584252094,0.00002394168096721290894,
		0.018727885294503432,0.0000238282381972251923,
		0.018686803087380691,0.000023715616392225677687,
		0.018645912579566489,0.000023603807565030017283,
		0.018605212401087208,0.000023492803825994237213,
		0.018564701195151269,0.000023382597381582363496,
		0.018524377617989768,0.000023273180532958608811,
		0.018484240338699424,0.000023164545674603638727,
		0.018444288039087816,0.000023056685292954446674,
		0.018404519413520847,0.000022949591965067377267,
		0.018364933168772426,0.000022843258357303847705,
		0.0183255280238763,0.000022737677224038326801,
		0.018286302709980026,0.000022632841406388140823,
		0.018247255970201032,0.000022528743830964684692,
		0.018208386559484737,0.000022425377508645626235,
		0.018169693244464689,0.000022322735533367700145,
		0.018131174803324705,0.000022220811080939696971,
		0.018092830025662958,0.000022119597407875261004,
		0.01805465771235799,0.000022019087850245119225,
		0.018016656675436621,0.000021919275822548371558,
		0.017978825737943717,0.000021820154816602480623,
		0.017941163733813787,0.000021721718400451606863,
		0.017903669507744389,0.000021623960217292942511,
		0.017866341915071292,0.000021526873984420705169,
		0.017829179821645399,0.000021430453492187459018,
		0.017792182103711365,0.000021334692602982438635,
		0.017755347647787917,0.000021239585250226557313,
		0.017718675350549821,0.000021145125437383788425,
		0.01768216411871149,0.000021051307236988614925,
		0.017645812868912186,0.000020958124789689248478,
		0.017609620527602815,0.000020865572303306325937,
		0.017573586030934264,0.000020773644051906796967,
		0.017537708324647278,0.000020682334374892722589,
		0.017501986363963829,0.000020591637676104710223,
		0.017466419113479978,0.000020501548422939716465,
		0.01743100554706019,0.000020412061145482954437,
		0.017395744647733075,0.000020323170435653647909,
		0.017360635407588556,0.00002023487094636437973,
		0.017325676827676411,0.000020147157390693787278,
		0.017290867917906188,0.00002006002454107236268,
		0.017256207696948469,0.000019973467228481120514,
		0.017221695192137452,0.00001988748034166290054,
		0.017187329439374841,0.000019802058826346077712,
		0.017153109483035017,0.00001971719768448045635,
		0.017119034375871471,0.00001963289197348512988,
		0.017085103178924485,0.000019549136805508091921,
		0.017051314961430031,0.000019465927346697388861,
		0.017017668800729885,0.000019383258816483608232,
		0.016984163782182913,0.000019301126486873501349,
		0.01695079899907754,0.000019219525681754542696,
		0.016917573552545359,0.000019138451776210232486,
		0.016884486551475881,0.000019057900195845952662,
		0.016851537112432389,0.000018977866416125190405,
		0.016818724359568904,0.000018898345961715946863,
		0.016786047424548222,0.000018819334405847152449,
		0.016753505446461022,0.000018740827369674913561,
		0.016721097571746015,0.000018662820521658419039,
		0.016688822954111141,0.000018585309576945338037,
		0.016656680754455763,0.00001850829029676654429,
		0.016624670140793885,0.000018431758487840004986,
		0.016561040378625941,0.000018280140734537245155,
		0.016497927151155583,0.000018130423658432712095,
		0.016435324051013491,0.000017982575292047966025,
		0.016373224777623047,0.000017836564341476899042,
		0.016311623134968354,0.000017692360169351760995,
		0.016250513029418282,0.000017549932778311239679,
		0.016189888467604897,0.000017409252794953714045,
		0.016129743554354691,0.000017270291454259436282,
		0.016070072490671082,0.000017133020584466009032,
		0.016010869571766699,0.000016997412592382109134,
		0.015952129185144021,0.000016863440449124969991,
		0.015893845808722985,0.000016731077676267672358,
		0.015836014009014222,0.000016600298332382808796,
		0.015778628439336623,0.000016471076999969581501,
		0.01572168383807798,0.0000163433887727518674,
		0.015665175026997498,0.000016217209243335239432,
		0.015609096909568982,0.000016092514491211369451,
		0.015553444469363585,0.000015969281071098657232,
		0.015498212768470997,0.000015847486001608332175,
		0.015443396945958023,0.000015727106754225660447,
		0.01538899221636351,0.000015608121242596261021,
		0.01533499386822862,0.000015490507812107890128,
		0.015281397262661492,0.000015374245229758395594,
		0.015228197831935345,0.000015259312674300871113,
		0.015175391078119117,0.000015145689726657356154,
		0.015122972571739757,0.00001503335636059273055,
		0.015070937950475319,0.000014922292933640744425,
		0.015019282917878034,0.000014812480178274404348,
		0.014968003242126545,0.000014703899193313206134,
		0.014917094754806546,0.000014596531435559963806,
		0.014866553349719056,0.000014490358711660233468,
		0.014816374981715605,0.000014385363170177570559,
		0.014766555665559619,0.000014281527293878089587,
		0.014717091474813326,0.000014178833892218017316,
		0.014667978540749496,0.000014077266094028143981,
		0.014619213051287395,0.000013976807340389282554,
		0.0145707912499523,0.000013877441377693044023,
		0.014522709434857986,0.000013779152250882427049,
		0.014474963957711571,0.000013681924296866903821,
		0.014427551222840179,0.00001358574213810686055,
		0.014380467686238822,0.00001349059067636242117,
		0.014333709854639,0.000013396455086601846712,
		0.014287274284597465,0.000013303320811064860688,
		0.014241157581604655,0.000013211173553476403008,
		0.014195356399212295,0.000013119999273406461546,
		0.014149867438179693,0.000013029784180771771812,
		0.01410468744563825,0.000012940514730475311434,
		0.014059813214273744,0.000012852177617179647466,
		0.01401524158152594,0.000012764759770210321244,
		0.0139709694288051,0.000012678248348585577597,
		0.013926993680724973,0.000012592630736168863058,
		0.013883311304351864,0.000012507894536940631343,
		0.01383991930846939,0.000012424027570386104004,
		0.013796814742858539,0.000012341017866995739935,
		0.013753994697592655,0.000012258853663875269502,
		0.013711456302346997,0.000012177523400462247579,
		0.013669196725722519,0.000012097015714346174873,
		0.013627213174583518,0.000012017319437189328718,
		0.013585502893408835,0.000011938423590745533179,
		0.013544063163656274,0.000011860317382974183855,
		0.013502891303139928,0.000011782990204246925473,
		0.013461984665420103,0.000011706431623644460162,
		0.013421340639205553,0.00001163063138534104143,
		0.013380956647767723,0.000011555579405074283373,
		0.013340830148366725,0.000011481265766697986622,
		0.013300958631688772,0.000011407680718815752097,
		0.013261339621294805,0.000011334814671493220858,
		0.013221970673080051,0.000011262658193046843335,
		0.013182849374744257,0.000011191202006907144006,
		0.013143973345272359,0.000011120436988554508348,
		0.013105340234425341,0.000011050354162525577558,
		0.013066947722241054,0.000010980944699488393358,
		0.013028793518544768,0.000010912199913384490081,
		0.012990875362469233,0.000010844111258636184342,
		0.012953191021984034,0.000010776670327417363992,
		0.012915738293434031,0.000010709868846986127727,
		0.012878515001086682,0.000010643698677077674828,
		0.012841518996688039,0.000010578151807355891035,
		0.012804748159027238,0.000010513220354922121574,
		0.012768200393509284,0.000010448896561879665974,
		0.012731873631735944,0.000010385172792952571447,
		0.012695765831094578,0.0000103220415331573425,
		0.012659874974354725,0.000010259495385526223934,
		0.012624199069272277,0.000010197527068880752713,
		0.012588736148201071,0.000010136129415654311234,
		0.012553484267711741,0.000010075295369762450444,
		0.012518441508217668,0.000010015017984519786028,
		0.012483605973607875,9.9552904206023045771e-6,
		0.012448975790886718,9.8961059440539492806e-6,
		0.012414549109820224,9.8374579243363863106e-6,
		0.012380324102588934,9.7793398324208837012e-6,
		0.01234629896344711,9.7217452389212642205e-6,
		0.012312471908388173,9.664667812266922504e-6,
		0.012278841174816231,9.6081013169149246141e-6,
		0.012245405021223585,9.5520396116002352231e-6,
		0.012212161726874064,9.4964766476231438291e-6,
		0.012179109591492076,9.4414064671729868278e-6,
		0.012146246934957268,9.3868232016872868997e-6,
		0.012113572097004645,9.332721070245455073e-6,
		0.012081083436930072,9.2790943779962239908e-6,
		0.012048779333301012,9.2259375146180033921e-6,
		0.012016658183672415,9.1732449528113706164e-6,
		0.011984718404307644,9.1210112468229300936e-6,
		0.011952958429904323,9.0692310309997963004e-6,
		0.011921376713325023,9.017899018373974576e-6,
		0.011889971725332677,8.9670099992759335088e-6,
		0.011858741954330628,8.916558839976681357e-6,
		0.011827685906107212,8.8665404813576771622e-6,
		0.011796802103584794,8.8169499376079248787e-6,
		0.011766089086573152,8.7677822949476159883e-6,
		0.011735545411527136,8.719032710377702713e-6,
		0.011705169651308504,8.6706964104548001016e-6,
		0.011674960394951857,8.6227686900908309566e-6,
		0.011644916247434584,8.5752449113768428068e-6,
		0.011615035829450752,8.5281205024304409278e-6,
		0.01158531777718884,8.4813909562662957863e-6,
		0.01155576074211326,8.4350518296891972444e-6,
		0.01152636339074958,8.3890987422091414201e-6,
		0.011497124404473374,8.3435273749779492762e-6,
		0.01146804247930264,8.2983334697469288081e-6,
		0.011439116325693698,8.253512827845105138e-6,
		0.011410344668340514,8.2090613091775549097e-6,
		0.011381726245977374,8.1649748312433931205e-6,
		0.011353259811184852,8.1212493681729719426e-6,
		0.011324944130198995,8.0778809497838621808e-6,
		0.011296777982723676,8.0348656606551987967e-6,
		0.011268760161746045,7.9921996392199824143e-6,
		0.011240889473355018,7.9498790768749389136e-6,
		0.011213164736562756,7.9079002171075491296e-6,
		0.01118558478312906,7.8662593546398703083e-6,
		0.011158148457388641,7.8249528345887803448e-6,
		0.011130854616081201,7.7839770516422849377e-6,
		0.011103702128184282,7.7433284492515366596e-6,
		0.011076689874748811,7.7030035188382235652e-6,
		0.011049816748737313,7.6629987990169933414e-6,
		0.011023081654864728,7.6233108748325871633e-6,
		0.010996483509441783,7.5839363770113653591e-6,
		0.010970021240220878,7.5448719812269147049e-6,
		0.010943693786244434,7.5061144073794346879e-6,
		0.010917500097695657,7.4676604188886073868e-6,
		0.010891439135751674,7.4295068219996627362e-6,
		0.010865509872438999,7.3916504651023578645e-6,
		0.010839711290491283,7.354088238062595939e-6,
		0.010814042383209308,7.3168170715664165132e-6,
		0.010788502154323177,7.2798339364760957553e-6,
		0.010763089617856675,7.2431358431981011634e-6,
		0.010737803797993743,7.2067198410626514183e-6,
		0.010712643728947038,7.1705830177146379292e-6,
		0.010687608454828538,7.1347224985156703607e-6,
		0.010662697029522155,7.0991354459570140266e-6,
		0.010637908516558319,7.0638190590831924748e-6,
		0.010613241988990495,7.0287705729260338956e-6,
		0.010588696529273609,6.9939872579489451462e-6,
		0.010564271229144327,6.9594664195012022196e-6,
		0.010539965189503184,6.9252053972820508852e-6,
		0.010515777520298497,6.8912015648144160038e-6,
		0.01049170734041206,6.8574523289280226732e-6,
		0.010467753777546566,6.8239551292517368933e-6,
		0.010443915968114742,6.7907074377149378563e-6,
		0.010420193057130152,6.7577067580577382738e-6,
		0.010396584198099657,6.7249506253498733469e-6,
		0.010373088552917483,6.6924366055180830745e-6,
		0.01034970529176088,6.6601622948818165805e-6,
		0.010326433592987347,6.6281253196970910257e-6,
		0.010303272643033384,6.5963233357083414569e-6,
		0.010280221636314755,6.5647540277081016384e-6,
		0.010257279775128232,6.5334151091043595092e-6,
		0.010234446269554792,6.5023043214954344217e-6,
		0.010211720337364246,6.4714194342522267358e-6,
		0.01018910120392127,6.4407582441076936842e-6,
		0.010166588102092824,6.4103185747534086746e-6,
		0.010144180272156921,6.3800982764430643726e-6,
		0.010121876961712734,6.3500952256027830007e-6,
		0.010099677425592013,6.3203073244481003127e-6,
		0.010077580925771795,6.2907325006074926434e-6,
		0.010055586731288375,6.2613687067523193121e-6,
		0.010033694118152524,6.2322139202330554558e-6,
		0.01001190236926594,6.2032661427216931085e-6,
		0.00999021077433889,6.174523399860191006e-6,
		0.00996861862980904,6.1459837409148562051e-6,
		0.00994712523876147,6.1176452384365431397e-6,
		0.00992572991084978,6.0895059879265582237e-6,
		0.00990443196221838,6.0615641075081605233e-6,
		0.00988323071542586,6.0338177376035513878e-6,
		0.00986212549936946,6.0062650406162482305e-6,
		0.00984111564921056,5.9789042006187399025e-6,
		0.00982020050630131,5.951733423045323299e-6,
		0.00979937941811221,5.9247509343900229795e-6,
		0.00977865173816078,5.8979549819094976804e-6,
		0.00975801682594115,5.8713438333308396397e-6,
		0.00973747404685475,5.8449157765641746485e-6,
		0.00971702277214182,5.8186691194199726963e-6,
		0.00969666237881402,5.7926021893309809748e-6,
		0.00967639224958787,5.7667133330786928683e-6,
		0.00965621177281916,5.7410009165242683689e-6,
		0.00963612034243828,5.7154633243438231309e-6,
		0.0096161173578864,5.6900989597680051077e-6,
		0.00959620222405256,5.6649062443257794064e-6,
		0.0095763743512116,5.6398836175923436471e-6,
		0.009556633154963,5.6150295369410977276e-6,
		0.00953697805617044,5.5903424772995934705e-6,
		0.00951740848090231,5.5658209309093911694e-6,
		0.00949792386037299,5.5414634070897515582e-6,
		0.00947852363088483,5.5172684320050931941e-6,
		0.00945920723377108,5.493234548436146685e-6,
		0.00943997411533948,5.4693603155547385945e-6,
		0.00942082372681662,5.4456443087021392314e-6,
		0.0094017555242931,5.4220851191709098681e-6,
		0.00938276896866937,5.3986813539901862491e-6,
		0.00936386352560234,5.3754316357143365248e-6,
		0.00934503866545264,5.3523346022149330044e-6,
		0.0093262938632327,5.3293889064759783415e-6,
		0.00930762859855535,5.306593216392327965e-6,
		0.00928904235558328,5.2839462145712517365e-6,
		0.00927053462297904,5.2614465981370789607e-6,
		0.00925210489385576,5.2390930785388719914e-6,
		0.00923375266572849,5.2168843813610747717e-6,
		0.00921547744046624,5.1948192461370837143e-6,
		0.00919727872424455,5.1728964261656893738e-6,
		0.00917915602749876,5.1511146883303383869e-6,
		0.00916110886487788,5.1294728129211661534e-6,
		0.00914313675519902,5.107969593459751712e-6,
		0.00912523922140246,5.0866038365265472194e-6,
		0.00910741579050727,5.0653743615909353779e-6,
		0.00908966599356753,5.0442800008438690709e-6,
		0.00907198936562908,5.0233195990330483627e-6,
		0.00905438544568687,5.0024920133005908924e-6,
		0.00903685377664283,4.9817961130231525511e-6,
		0.00901939390526429,4.9612307796544561674e-6,
		0.00900200538214293,4.9407949065701867487e-6,
		0.00898468776165427,4.9204873989152126271e-6,
		0.00896744060191762,4.9003071734530926432e-6,
		0.00895026346475664,4.8802531584178302717e-6,
		0.0089331559156603,4.8603242933678363424e-6,
		0.00891611752374438,4.840519529042062748e-6,
		0.00889914786171346,4.8208378272182702489e-6,
		0.0088822465058234,4.801278160573394191e-6,
		0.00886541303584426,4.7818395125459726423e-6,
		0.00884864703502366,4.7625208772006021289e-6,
		0.00883194809005072,4.7433212590943868131e-6,
		0.0088153157910203,4.7242396731453476028e-6,
		0.00879874973139779,4.7052751445027583142e-6,
		0.0087822495079843,4.6864267084193766327e-6,
		0.00876581472088228,4.6676934101255382202e-6,
		0.00874944497346158,4.6490743047050829156e-6,
		0.00873313987232591,4.6305684569730825535e-6,
		0.00871689902727973,4.6121749413553405012e-6,
		0.00870072205129559,4.5938928417696335652e-6,
		0.00868460856048173,4.5757212515086674731e-6,
		0.00866855817405028,4.5576592731247176658e-6,
		0.00865257051428566,4.5397060183159276612e-6,
		0.00863664520651351,4.5218606078142377667e-6,
		0.00862078187906988,4.5041221712749174155e-6,
		0.00860498016327091,4.4864898471676748994e-6,
		0.00858923969338279,4.4689627826693187499e-6,
		0.0085735601065921,4.4515401335579454932e-6,
		0.00855794104297656,4.434221064108628969e-6,
		0.00854238214547607,4.4170047469905868536e-6,
		0.00852688305986413,4.3998903631658004757e-6,
		0.0085114434347196,4.3828771017890644452e-6,
		0.00849606292139882,4.3659641601094430454e-6,
		0.00848074117400798,4.3491507433731107543e-6,
		0.00846547784937595,4.332436064727554671e-6,
		0.00845027260702732,4.3158193451271170251e-6,
		0.00843512510915582,4.2992998132398563405e-6,
		0.00842003502059803,4.2828767053557062083e-6,
		0.00840500200880742,4.2665492652959110045e-6,
		0.00839002574382871,4.2503167443237182557e-6,
		0.00837510589827246,4.2341784010563077192e-6,
		0.00836024214729006,4.218133501377937602e-6,
		0.00834543416854894,4.2021813183542886881e-6,
		0.0083306816422081,4.1863211321479874872e-6,
		0.0083159842508939,4.1705522299352898539e-6,
		0.00830134167967621,4.1548739058239068517e-6,
		0.00828675361604473,4.1392854607719549616e-6,
	};

	bool newspc = true, jacatt = false, last;
	const unsigned mmax = 2003;
	unsigned nstsig = 0;
	const double tdir = xend - x > 0 ? 1. : -1.;
	const double hmax = tdir * (xend - x);
	const double facmax = 10;
	const double errpow = 0.5;
	double hmin = 10. * uround * fmax(fabs(x), hmax);
	double absh, h, abshold, est, sprad, wt, at, err, errold, fac, temp, ci;
	double acoshw0, w1, b, c, d;
	unsigned i, m;

	double* yn = &work[0];
	double* fn = &work[n];
	double* vtemp1 = &work[2 * n];
	double* vtemp2 = &work[3 * n];

	double* eigvec = NULL;
	if (iwork[0] == 0)
	{
		eigvec = &work[4 * n];
	}

	double* swap, * res = y;

	memcpy(yn, y, n * sizeof(double));
	f(&n, &x, yn, fn);
	iwork[4]++;

	while (true)
	{
		if (newspc)
		{
			if (iwork[0] == 1)
			{
				rho(&n, &x, yn, &sprad);
			}
			else
			{
				sprad = mono_rho(n, x, f, yn, fn, vtemp1, vtemp2, eigvec, hmax, uround, iwork);
				if (sprad < 0)
				{
					return 6;
				}
			}
			jacatt = true;
		}

		if (iwork[5] == 0)
		{
			absh = hmax;
			if (sprad * absh > 1.)
			{
				absh = 1. / sprad;
			}
			absh = fmax(absh, hmin);

			for (i = 0; i < n; i++)
			{
				vtemp1[i] = yn[i] + absh * fn[i];
			}
			ci = x + absh;
			f(&n, &ci, vtemp1, vtemp2);
			iwork[4]++;

			est = 0.;
			at = atol[0];
			for (i = 0; i < n; i++)
			{
				if (iwork[3])
				{
					at = atol[i];
				}
				wt = at + rtol * fabs(yn[i]);
				if (wt == 0.)
				{
					return 3;
				}
				est += pow((vtemp2[i] - fn[i]) / wt, 2);
			}
			est = absh * sqrt(est / n);
			if (0.1 * absh < hmax * sqrt(est))
			{
				absh = fmax(0.1 * absh / sqrt(est), hmin);
			}
			else
			{
				absh = hmax;
			}
		}

		last = false;
		if (1.1 * absh >= fabs(xend - x))
		{
			absh = fabs(xend - x);
			last = true;
		}

		m = 1 + (unsigned)pow(2.33 * absh * sprad, 0.55);
		if (m < 3)
		{
			m = 3;
		}
		else if (m > mmax)
		{
			m = mmax;
			absh = pow(m, 1.8181818181818181) / (2.33 * sprad);
			last = false;
		}

		if (m <= 451)
		{
			i = 2 * (m - 3);
		}
		else if (m <= 903)
		{
			m += 1 - (m % 2);
			i = (m - 451) + 896;
		}
		else
		{
			m += 3 - (m % 4);
			i = (m - 903) / 2 + 1348;
		}
		acoshw0 = coef[i];
		w1 = coef[i + 1];

		c = 0.5 / (m * w1 * (1 + cosh((m - 1) * acoshw0)));
		d = c * m / (m - 2);
		b = d * (2 * m - 4) * w1;

		h = tdir * absh;
		step_mono(n, x, f, yn, fn, h, m, acoshw0, w1, b, c, d, y, vtemp1, vtemp2);

		hmin = 10. * uround * fmax(fabs(x), fabs(x + h));
		iwork[9] = m > iwork[9] ? m : iwork[9];

		ci = x + h;
		f(&n, &ci, y, vtemp1);
		iwork[4] += m;
		iwork[5]++;

		err = 0.;
		at = atol[0];
		for (i = 0; i < n; i++)
		{
			if (iwork[3])
			{
				at = atol[i];
			}
			wt = at + rtol * fmax(fabs(y[i]), fabs(yn[i]));
			if (wt == 0)
			{
				return 3;
			}

			est = 0.1 * (yn[i] - y[i] + h * vtemp1[i]);
			err = err + pow(est / wt, 2);
		}
		err = sqrt(err / n);

		if (!isfinited(err))
		{
			return 4;
		}
		if (err > 1.)
		{
			iwork[7]++;

			absh *= 0.8 * pow(err, -errpow);
			if (absh < hmin)
			{
				return 4;
			}
			else
			{
				newspc = !jacatt;
				continue;
			}
		}

		if (iwork[2] == 1)
		{
			solout(n, x, x + h, y);
		}

		iwork[6]++;
		x += h;

		if (last)
		{
			if (res != y)
			{
				memcpy(res, y, n * sizeof(double));
			}
			return 1;
		}

		jacatt = iwork[1] == 1;
		nstsig = (nstsig + 1) % 25;
		if (iwork[0] == 1 || nstsig == 0)
		{
			newspc = !jacatt;
		}
		else
		{
			newspc = false;
		}

		swap = vtemp2;
		vtemp2 = fn;
		fn = vtemp1;
		vtemp1 = yn;
		yn = y;
		y = swap;

		fac = pow(err, -errpow);
		if (iwork[6] > 1)
		{
			temp = pow(errold, errpow) * fac * fac * absh / abshold;
			fac = fmin(fac, temp);
		}
		abshold = absh;
		absh *= fmax(0.1, fmin(0.8 * fac, facmax));
		absh = fmax(hmin, fmin(hmax, absh));
		errold = err;
	}
}


int mono(const unsigned n, const double x, const double xend, double* y,
	const FcnEqDiff f, const Rho rho, const SolTrait solout,
	const double* atol, const double rtol,
	unsigned iwork[10])
{
	const double uround = 1e-16;

	if (n <= 0 || atol[0] <= 0 || rtol < 10. * uround)
	{
		return 5;
	}

	if (iwork[3])
	{
		for (unsigned i = 1; i < n; i++)
		{
			if (atol[i] <= 0)
			{
				return 5;
			}
		}
	}

	iwork[4] = 0, iwork[5] = 0, iwork[6] = 0,
	iwork[7] = 0, iwork[8] = 0, iwork[9] = 0;

	unsigned long long work_length = 4;
	if (iwork[0] == 0)
	{
		work_length++;
	}
	double* work = (double*)malloc(work_length * n * sizeof(double));

	int idid = mono_core(n, x, xend, y, f, rho, solout, atol, rtol, uround, work, iwork);

	free(work);

	return idid;
}